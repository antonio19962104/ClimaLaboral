@model ML.Result
@{
    ViewBag.Title = "GetDataFromBD";
    Layout = null;
}

<!DOCTYPE html>
<html lang="es-es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>@ViewBag.Title</title>
    @Styles.Render("~/bundles/cssAdmin")
    @{
        //Session["PerfilAdminLog"]
        ViewBag.Perfil = Session["PerfilAdminLog"];
    }
    @Scripts.Render("~/bundles/jqueryAdmin")
    @*<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.7.7/xlsx.core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xls/0.7.4-a/xls.core.min.js"></script>*@
    @*<script src="~/scripts/excel.min.js"></script>*@
</head>
<body>
    <ul id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn d-none" onclick="closeNav()"><i class="fas fa-arrow-left fa-lg color"></i></a>
        <span class="openbtn animated pulse slow" onclick="openNav()"><i class="fas fa-arrow-right fa-lg color"></i></span>


        <!--Seccion Permisos por usuario-->
        @{
            //Validar permisos
            var ActionEncuestasListar = false;
            var ActionEncuestasCrear = false;
            var ActionEncuestasOpc = false;

            var ActionPlantillasListar = false;
            var ActionPlantillasCrear = false;
            var ActionPlantillasOpc = false;

            var ActionReportesListar = false;
            var ActionReportesCrear = false;
            var ActionReportesOpc = false;

            var ActionBDListar = false;
            var ActionBDCrear = false;
            var ActionBDOpc = false;

            var ActionUsuariosListar = false;
            var ActionUsuariosCrear = false;
            var ActionUsuariosOpc = false;

            var ActionEmpresasListar = false;
            var ActionEmpresasCrear = false;
            var chkEmpresasOpc = false;

            var chkPlanesListar = false;
            var chkPlanesCrear = false;
            var chkAdminAcciones = false;

            var session = Session["AdminLog"];
            var sessionPerfil = Session["PerfilAdminLog"];


            ViewBag.Permisos = Session["Permisos"];
            ViewBag.Modulos = Session["Modulos"];
            //Model.ObjectsPermisos = new List<object>();
            //Model.ObjectsPermisos = ViewBag.Permisos;

            foreach (ML.PerfilModulo item in ViewBag.Permisos)
            {
                if (item.Modulo.Nombre == "Encuestas" && item.PerfilModuloAccion.Accion == "ListarEncuesta")
                {
                    ActionEncuestasListar = true;
                }
                if (item.Modulo.Nombre == "Encuestas" && item.PerfilModuloAccion.Accion == "CrearEncuesta")
                {
                    ActionEncuestasCrear = true;
                }
                if (item.Modulo.Nombre == "Encuestas" && item.PerfilModuloAccion.Accion == "OpcEncuesta")
                {
                    ActionEncuestasOpc = true;
                }
                /**********************/
                if (item.Modulo.Nombre == "Plantillas" && item.PerfilModuloAccion.Accion == "ListarPlantilla")
                {
                    ActionPlantillasListar = true;
                }
                if (item.Modulo.Nombre == "Plantillas" && item.PerfilModuloAccion.Accion == "CrearPlantilla")
                {
                    ActionPlantillasCrear = true;
                }
                if (item.Modulo.Nombre == "Plantillas" && item.PerfilModuloAccion.Accion == "OpcPlantilla")
                {
                    ActionPlantillasOpc = true;
                }
                /***********************************/
                if (item.Modulo.Nombre == "Reportes" && item.PerfilModuloAccion.Accion == "ListarReporte")
                {
                    ActionReportesListar = true;
                }
                if (item.Modulo.Nombre == "Reportes" && item.PerfilModuloAccion.Accion == "CrearReporte")
                {
                    ActionReportesCrear = true;
                }
                if (item.Modulo.Nombre == "Reportes" && item.PerfilModuloAccion.Accion == "OpcReporte")
                {
                    ActionReportesOpc = true;
                }
                /***************************************/
                if (item.Modulo.Nombre == "Base de datos" && item.PerfilModuloAccion.Accion == "ListarBD")
                {
                    ActionBDListar = true;
                }
                if (item.Modulo.Nombre == "Base de datos" && item.PerfilModuloAccion.Accion == "CrearBD")
                {
                    ActionBDCrear = true;
                }
                if (item.Modulo.Nombre == "Base de datos" && item.PerfilModuloAccion.Accion == "OpcBD")
                {
                    ActionBDOpc = true;
                }
                /*******************************/
                if (item.Modulo.Nombre == "Usuarios" && item.PerfilModuloAccion.Accion == "ListarUsuario")
                {
                    ActionUsuariosListar = true;
                }
                if (item.Modulo.Nombre == "Usuarios" && item.PerfilModuloAccion.Accion == "CrearUsuario")
                {
                    ActionUsuariosCrear = true;
                }
                if (item.Modulo.Nombre == "Usuarios" && item.PerfilModuloAccion.Accion == "OpcUsuario")
                {
                    ActionUsuariosOpc = true;
                }
                /*********************************/
                if (item.Modulo.Nombre == "Empresas" && item.PerfilModuloAccion.Accion == "ListarEmpresa")
                {
                    ActionEmpresasListar = true;
                }
                if (item.Modulo.Nombre == "Empresas" && item.PerfilModuloAccion.Accion == "CrearEmpresa")
                {
                    ActionEmpresasCrear = true;
                }
                if (item.Modulo.Nombre == "Empresas" && item.PerfilModuloAccion.Accion == "OpcEmpresa")
                {
                    chkEmpresasOpc = true;
                }
                if (item.Modulo.Nombre == "Planes de Acción" && item.PerfilModuloAccion.Accion == "ListarPlanes")
                {
                    <script>
                        localStorage.setItem("ListarPlanes", true)
                    </script>
                    chkPlanesListar = true;
                }
                if (item.Modulo.Nombre == "Planes de Acción" && item.PerfilModuloAccion.Accion == "CrearPlanes")
                {
                    <script>
                        localStorage.setItem("CrearPlanes", true)
                    </script>
                    chkPlanesCrear = true;
                }
                if (item.Modulo.Nombre == "Planes de Acción" && item.PerfilModuloAccion.Accion == "AdministrarAcciones")
                {
                    <script>
                        localStorage.setItem("AdministrarAcciones", true)
                    </script>
                    chkAdminAcciones = true;
                }
            }

            foreach (ML.PerfilModulo perf in ViewBag.Modulos)
            {
                ML.PerfilModulo perfilModulo = new ML.PerfilModulo();
                perfilModulo.Modulo = new ML.Modulo();

                perfilModulo.Modulo.Nombre = perf.Modulo.Nombre;

                if (perfilModulo.Modulo.Nombre == "Encuestas")
                {
                    <li id="Encuestas">
                        <a onclick="openNav(this)" data-toggle="collapse" href="#collapseSurvey" aria-controls="collapseSurvey" style="padding: 0px;">
                            <div class="item-menu-icon">
                                <img src="~/img/icon-survey.png" alt="Icono Encuestas" class="img-white">
                                <span class="tooltiptext">Encuestas</span>
                            </div>
                        </a>
                        <span class="item-menu d-none">
                            <a onclick="openNav(this)" data-toggle="collapse" href="#collapseSurvey" role="button" aria-expanded="false" aria-controls="collapseSurvey">
                                <img src="~/img/icon-survey.png" class="img-white pr-3" alt="Icono Encuestas"> Encuestas
                            </a>
                        </span>
                        <div class="collapse" id="collapseSurvey">
                            <div class="card card-body py-2">
                                <ul class="fa-ul pl-lg-4">
                                    @{
                                        if (ActionEncuestasCrear == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("Create", "Encuesta")">Crear</a></li>
                                        }
                                        if (ActionEncuestasOpc == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("Load", "Encuesta")">Importar encuesta</a></li>
                                        }
                                        if (ActionEncuestasListar == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("GetAll", "Encuesta")">Listado</a></li>
                                        }
                                        <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("CreateCL", "Encuesta")">Crear Clima Laboral</a></li>
                                        <li style="margin-left: 20px;"><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("GetAll", "Competencia")">Competencias</a></li>
                                        <li style="margin-left: 20px;"><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("GetAll_", "Competencia")">Categorias</a></li>
                                        <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("Index", "PlanesDeAccion")">Crear Plan de Acción</a></li>
                                    }
                                </ul>
                            </div>
                        </div>
                    </li>
                }
                if (perfilModulo.Modulo.Nombre == "Plantillas")
                {
                    <li id="Plantillas">
                        <a onclick="openNav(this)" data-toggle="collapse" href="#collapseTemplates" aria-controls="collapseTemplates" style="padding: 0px;">
                            <div class="item-menu-icon">
                                <img src="~/img/icon-template.png" alt="Icono Plantillas" class="img-white">
                                <span class="tooltiptext">Plantillas</span>
                            </div>
                        </a>
                        <span class="item-menu d-none">
                            <a onclick="openNav(this)" data-toggle="collapse" href="#collapseTemplates" role="button" aria-expanded="false" aria-controls="collapseTemplates">
                                <img src="~/img/icon-template.png" class="img-white pr-3" alt="Icono Plantillas"> Plantillas
                            </a>
                        </span>
                        <div class="collapse" id="collapseTemplates">
                            <div class="card card-body py-2">
                                <ul class="fa-ul pl-lg-4">
                                    @{
                                        if (ActionPlantillasCrear == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("creaPlantilla", "Plantillas")">Crear</a></li>
                                        }
                                        if (ActionPlantillasListar == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("Plantillas", "Plantillas")">Listado</a></li>
                                        }
                                        if (ActionPlantillasOpc == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="#">Más opciones</a></li>
                                        }
                                    }
                                </ul>
                            </div>
                        </div>
                    </li>
                }
                if (perfilModulo.Modulo.Nombre == "Reportes")
                {
                    <li id="Reportes">
                        <a onclick="openNav(this)" data-toggle="collapse" href="#collapseReports" aria-controls="collapseReports" style="padding: 0px;">
                            <div class="item-menu-icon">
                                <img src="~/img/icon-reports.png" alt="Icono Reportes" class="img-white">
                                <span class="tooltiptext">Reportes</span>
                            </div>
                        </a>
                        <span class="item-menu d-none">
                            <a onclick="openNav(this)" data-toggle="collapse" href="#collapseReports" role="button" aria-expanded="false" aria-controls="collapseReports">
                                <img src="~/img/icon-reports.png" class="img-white pr-3" alt="Icono Reportes"> Reportes
                            </a>
                        </span>
                        <div class="collapse" id="collapseReports">
                            <div class="card card-body py-2">
                                <ul class="fa-ul pl-lg-4">
                                    @{
                                        if (ActionReportesCrear == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("Add", "ReporteD4U")">Crear</a></li>
                                        }
                                        if (ActionReportesListar == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("GetAll", "Reporte")">Listado</a></li>
                                        }
                                        if (ActionReportesOpc == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="#">Más opciones</a></li>
                                        }
                                    }
                                </ul>
                            </div>
                        </div>
                    </li>
                }
                if (perfilModulo.Modulo.Nombre == "Base de datos")
                {
                    <li id="BD">
                        <a onclick="openNav(this)" data-toggle="collapse" href="#collapseDatabase" aria-controls="collapseDatabase" style="padding: 0px;">
                            <div class="item-menu-icon">
                                <img src="~/img/icon-database.png" alt="Icono Bases de datos" class="img-white">
                                <span class="tooltiptext">Bases de datos</span>
                            </div>
                        </a>
                        <span class="item-menu d-none">
                            <a onclick="openNav(this)" data-toggle="collapse" href="#collapseDatabase" role="button" aria-expanded="false" aria-controls="collapseDatabase">
                                <img src="~/img/icon-database.png" class="img-white pr-3" alt="Icono Bases de datos"> Bases de datos
                            </a>
                        </span>
                        <div class="collapse" id="collapseDatabase">
                            <div class="card card-body py-2">
                                <ul class="fa-ul pl-lg-4">
                                    @{
                                        if (ActionBDCrear == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("Add", "BD")">Crear</a></li>
                                        }
                                        if (ActionBDListar == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("GetAllForListado", "BD")">Listado</a></li>
                                        }
                                        if (ActionBDOpc == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("GetEliminadas", "BD")">Administrar bases de datos eliminadas</a></li>
                                        }
                                    }
                                </ul>
                            </div>
                        </div>
                    </li>
                }
                if (perfilModulo.Modulo.Nombre == "Usuarios")
                {
                    <li id="Usuarios">
                        <a onclick="openNav(this)" data-toggle="collapse" href="#collapseUsers" aria-controls="collapseUsers" style="padding: 0px;">
                            <div class="item-menu-icon">
                                <img src="~/img/icon-users.png" alt="Icono Usuarios" class="img-white">
                                <span class="tooltiptext">Usuarios</span>
                            </div>
                        </a>
                        <span class="item-menu d-none">
                            <a onclick="openNav(this)" data-toggle="collapse" href="#collapseUsers" role="button" aria-expanded="false" aria-controls="collapseUsers">
                                <img src="~/img/icon-users.png" class="img-white pr-3" alt="Icono Usuarios"> Usuarios
                            </a>
                        </span>
                        <div class="collapse" id="collapseUsers">
                            <div class="card card-body py-2">
                                <ul class="fa-ul pl-lg-4">
                                    @{
                                        if (ActionUsuariosCrear == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("Add", "Administrador")">Crear</a></li>
                                        }
                                        if (ActionUsuariosListar == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("GetAll", "Administrador")">Listado</a></li>
                                        }
                                        if (ActionUsuariosOpc == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("GetAllEliminados", "Administrador")">Administrar usuarios eliminadas</a></li>
                                        }
                                    }
                                </ul>
                            </div>
                        </div>
                    </li>
                }
                if (perfilModulo.Modulo.Nombre == "Empresas")
                {
                    <li id="Empresas">
                        <a onclick="openNav(this)" data-toggle="collapse" href="#collapseEnterprises" aria-controls="collapseEnterprises" style="padding: 0px;">
                            <div class="item-menu-icon">
                                <img src="~/img/icon-enterprises.png" alt="Icono Empresas" class="img-white">
                                <span class="tooltiptext">Empresas</span>
                            </div>
                        </a>
                        <span class="item-menu d-none">
                            <a onclick="openNav(this)" data-toggle="collapse" href="#collapseEnterprises" role="button" aria-expanded="false" aria-controls="collapseEnterprises">
                                <img src="~/img/icon-enterprises.png" class="img-white pr-3" alt="Icono Empresas"> Empresas
                            </a>
                        </span>
                        <div class="collapse" id="collapseEnterprises">
                            <div class="card card-body py-2">
                                <ul class="fa-ul pl-lg-4">
                                    @{
                                        if (ActionEmpresasCrear == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("Add", "Empresa")">Crear</a></li>
                                        }
                                        if (ActionEmpresasListar == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("GetAll", "Empresa")">Listado</a></li>
                                        }
                                        if (chkEmpresasOpc == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("GetAllEliminadas", "Empresa")">Administrar empresas eliminadas</a></li>
                                        }
                                    }
                                </ul>
                            </div>
                        </div>
                    </li>
                }
                if (perfilModulo.Modulo.Nombre == "Planes de Acción")
                {
                    <li id="Planes">
                        <a onclick="openNav(this)" data-toggle="collapse" href="#collapsePlanes" aria-controls="collapsePlanes" style="padding: 0px;">
                            <div class="item-menu-icon">
                                <img src="~/img/plan-de-accion-2.png" alt="Icono Encuestas" class="img-white">
                                <span class="tooltiptext">Planes de Acción</span>
                            </div>
                        </a>
                        <span class="item-menu d-none">
                            <a onclick="openNav(this)" data-toggle="collapse" href="#collapsePlanes" role="button" aria-expanded="false" aria-controls="collapsePlanes">
                                <img src="~/img/plan-de-accion-2.png" class="img-white pr-3" alt="Icono Encuestas"> Planes de Acción
                            </a>
                        </span>
                        <div class="collapse" id="collapsePlanes">
                            <div class="card card-body py-2">
                                <ul class="fa-ul pl-lg-4">
                                    @{
                                        if (chkPlanesListar == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("GetAll", "PlanesDeAccion")">Listado</a></li>
                                        }
                                        if (chkPlanesCrear == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("Create", "PlanesDeAccion")">Crear</a></li>
                                        }
                                        if (chkAdminAcciones == true)
                                        {
                                            <li><span class="fa-li"><i class="fas fa-minus"></i></span> <a href="@Url.Action("GetEncuestas", "PlanesDeAccion")">Administrar acciones</a></li>
                                        }
                                    }
                                </ul>
                            </div>
                        </div>
                    </li>
                }
            }
        }
        <!--Fin seccion permisos por usuario-->



    </ul>

    <div id="main" style="margin-left: 50px;">
        <main id="wrapper" class="animate fadeIn">
            


                    <div id="top-bar">
                        <div class="container-fluid px-lg-5">
                            <div class="row center-vertically">
                                @*<div class="col-6 bottom-align-left center-vertically-xs">
                                    <img src="~/img/icon-database.png" class="img-fluid">
                                    <h1 class="title-page-survey">
                                        Base de datos / <span>@Session["BDNombre"]</span>
                                    </h1>
                                </div>*@
                                <div class="col-6 col-sm-4 col-md-5">
                                    <img src="@Session["logo"]" class="logo-header" alt="Logo" onclick="GetDashBoard()">
                                </div>

                                <div class="col-6 col-sm-8 col-md-7">
                                    <div class="user-info">
                                        <!--<span class="color">Hola</span>--><a class="" href="@Url.Action("Login", "LoginAdmin")">Cerrar sesión</a> , @Session["AdminLog"]  @{ foreach (var item in ViewBag.Perfil)
                                            { <span class="position"> / @item  </span> } } <img src="~/img/icon-user-male.jpg" class="avatar-header" width="50" height="50" alt="Avatar">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <section id="page-title">
                        <div class="col-6 bottom-align-left center-vertically-xs">
                            <img src="~/img/icon-database.png" class="img-fluid">
                            <h1 class="title-page-survey">
                                Base de datos / <span>@Session["BDNombre"]</span>
                            </h1>
                        </div>
                    </section>
                


                @*<section class="" id="content">*@
                <div class="content-wrap">
                    <div class="container-fluid px-lg-5">
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="col-lg-12 col-md-12 col-xs-12 col-sm-12">
                                    <div class="col-lg-6 col-md-6 col-xs-6 col-sm-6">
                                        <ul hidden>
                                            <li>Descarga layout</li>
                                            <li>Agregar Usuarios</li>
                                            <li>Desargar BD</li>
                                            <li>Actualizar BD</li>
                                            <li>Sobreescribir BD</li>
                                        </ul>
                                        @*<div id="addBulk" class="dt-buttons">
                                            <a href="" class="btn btn-secondary btn-action btn-sm" data-toggle="modal" data-target="#modalAddBulk">
                                                Agregar Usuarios<i class="fas fa-plus-square ml-1"></i>
                                            </a>
                                        </div>
                                        <div class="dt-buttons">
                                            <a id="DownloadLayout" style="" href="@Url.Action("DownloadLayout")" class="btn btn-secondary btn-action btn-sm" data-toggle="" data-target="">
                                                Descargar Layout<i class="fas fa-file-excel ml-1"></i>
                                            </a>
                                        </div>
                                        <div class="dt-buttons">
                                            <a id="UpdateBulk" style="" class="btn btn-secondary btn-action btn-sm" data-toggle="modal" data-target="#modalUpdateBulk">
                                                Actualizar datos<i class="fas fa-file-excel ml-1"></i>
                                            </a>
                                        </div>*@
                                    </div>
                                    <table id="myTable" class="table table-hover table-responsive">
                                        @*<caption>Usuarios en la Base de datos</caption>*@
                                        <thead>
                                            <tr>
                                                @{
                                                    var idtipo = Convert.ToInt32(Session["TipoBD"]);
                                                    if (idtipo == 2)
                                                    {
                                                        <th class="text-center" scope="col">
                                                            <strong>Editar</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>IdUsuario</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Password</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Nombre</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Apellido Paterno</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Apellido Materno</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Puesto</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>FechaNacimiento</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>FechaAntiguedad</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Sexo</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Email</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>TipoFuncion</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>CondicionTrabajo</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>GradoAcademico</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>UnidadNegocio</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>DivisionMarca</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>AreaAgencia</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Departamento</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Subdepartamento</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Empresa contratante</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>IdResponsableRH</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>NombreResponsableRH</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>IdJefe</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>NombreJefe</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>puestoJefe</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>IdResponsableEstructura</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>NombreResponsableEstructura</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>ClaveAcceso</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>RangoAntiguedad</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>RangoEdad</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>EstatusEmpleado</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>CampoNumerico_1</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>CampoDeTexto_1</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>CampoNumerico_2</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>CampoDeTexto_2</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>CampoNumerico_3</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>CampoDeTexto_3</strong>
                                                        </th>
                                                    }
                                                    else if (idtipo == 1)
                                                    {
                                                        <th class="text-center" scope="col">
                                                            <strong>Editar</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>IdEncuestado</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>IdEmpleadoRH</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Password</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Nombre</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Apellido Paterno</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Apellido Materno</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Puesto</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>FechaNacimiento</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>FechaAntiguedad</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Sexo</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Email</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>TipoFuncion</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>CondicionTrabajo</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>GradoAcademico</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>UnidadNegocio</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>DivisionMarca</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>AreaAgencia</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Departamento</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Subdepartamento</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>Empresa contratante</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>IdResponsableRH</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>NombreResponsableRH</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>IdJefe</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>NombreJefe</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>puestoJefe</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>IdResponsableEstructura</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>NombreResponsableEstructura</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>ClaveAcceso</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>RangoAntiguedad</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>RangoEdad</strong>
                                                        </th>
                                                        <th class="text-center" scope="col">
                                                            <strong>EstatusEmpleado</strong>
                                                        </th>

                                                    }
                                                }

                                            </tr>
                                        </thead>
                                        <tbody>
                                            @{
                                                var idtipoBD = Convert.ToInt32(Session["TipoBD"]);
                                                if (idtipoBD == 2)
                                                {
                                                    foreach (ML.Usuario BDUsuario in Model.Objects)
                                                    {
                                                        <tr>
                                                            <td class="text-center">
                                                                <button value="@BDUsuario.IdUsuario" onclick="GetUpdate($(this).val()); " class="btn btn-secondary btn-action btn-sm" data-toggle="modal" data-target="#modalEdit">
                                                                    Editar datos<i class="fas fa-pencil-alt ml-1"></i>
                                                                </button>
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.IdUsuario
                                                            </td>
                                                            @*<td class="text-center">
                                                                    @BDUsuario.Username
                                                                </td>*@
                                                            <td class="text-center">
                                                                @BDUsuario.Password
                                                            </td>
                                                            @*<td class="text-center">
                                                                    @BDUsuario.Empleado.IdEmpleado
                                                                </td>*@
                                                            @*<td class="text-center">
                                                                    @BDUsuario.Perfil.Descripcion
                                                                </td>*@
                                                            <td class="text-center">
                                                                @BDUsuario.Nombre
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.ApellidoPaterno
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.ApellidoMaterno
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.Puesto
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.cadenaDateNacimiento
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.cadenaDateAntiguedad
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.Sexo
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.Email
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.TipoFuncion
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.CondicionTrabajo
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.GradoAcademico
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.UnidadNegocio
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.DivisionMarca
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.AreaAgencia
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.Departamento
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.Subdepartamento
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.EmpresaContratante
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.IdResponsableRH
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.NombreResponsableRH
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.IdJefe
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.NombreJefe
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.PuestoJefe
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.IdRespinsableEstructura
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.NombreResponsableEstructura
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.ClaveAcceso
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.RangoAntiguedad
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.RangoEdad
                                                            </td>
                                                            @*<td class="text-center">
                                                                    @BDUsuario.EstatusEncuesta.Estatus
                                                                </td>*@


                                                            @{
                                                                if (BDUsuario.TipoEstatus.Descripcion == "Activo")
                                                                {
                                                                    <td class="text-center">
                                                                        Activo
                                                                    </td>
                                                                }
                                                                else if (BDUsuario.TipoEstatus.Descripcion == "Desactivado")
                                                                {
                                                                    <td class="text-center">
                                                                        Inactivo
                                                                    </td>
                                                                }
                                                            }


                                                            <td class="text-center">
                                                                @BDUsuario.CampoNumerico_1
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.CampoDeTexto_1
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.CampoNumerico_2
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.CampoDeTexto_2
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.CampoNumerico_3
                                                            </td>
                                                            <td class="text-center">
                                                                @BDUsuario.CampoDeTexto_3
                                                            </td>

                                                        </tr>
                                                                    }
                                                                }
                                                                else if (idtipoBD == 1)
                                                                {
                                                                    foreach (ML.Empleado empleado in Model.Objects)
                                                                    {
                                                                        <tr>
                                                                            <td class="text-center">
                                                                                <button value="@empleado.IdEmpleado" onclick="GetUpdateEmpleado($(this).val())" class="btn btn-secondary btn-action btn-sm" data-toggle="modal" data-target="#modalEdit">
                                                                                    Editar datos<i class="fas fa-pencil-alt ml-1"></i>
                                                                                </button>
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.IdEmpleado
                                                                            </td>
                                                                            <td class="text-center">
                                                                                    @empleado.IdEmpleadoRH
                                                                                </td>
                                                                            <td class="text-center">
                                                                                @empleado.ClavesAcceso.ClaveAcceso
                                                                            </td>
                                                                            @*<td class="text-center">
                                                                                    @BDUsuario.Empleado.IdEmpleado
                                                                                </td>*@
                                                                            @*<td class="text-center">
                                                                                    @BDUsuario.Perfil.Descripcion
                                                                                </td>*@
                                                                            <td class="text-center">
                                                                                @empleado.Nombre
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.ApellidoPaterno
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.ApellidoMaterno
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.Puesto
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.dateNacim
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.dateAntig
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.Sexo
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.Correo
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.TipoFuncion
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.CondicionTrabajo
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.GradoAcademico
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.UnidadNegocio
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.DivisonMarca
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.AreaAgencia
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.Depto
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.Subdepto
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.EmpresaContratante
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.IdResponsableRH
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.NombreResponsableRH
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.IdJefe
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.NombreJefe
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.PuestoJefe
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.IdRespinsableEstructura
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.NombreResponsableEstrucutra
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.ClavesAcceso.ClaveAcceso
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.RangoAntiguedad
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.RangoEdad
                                                                            </td>
                                                                            <td class="text-center">
                                                                                @empleado.EstatusEmpleado
                                                                            </td>

                                                                        </tr>
                                                                    }
                                                                }
                                            }

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
                @*</section>*@
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>
                <script>
                    /*
                     * verificar funcion 
                    */
                    var excelValido = false;
                    var propiertiesExcel = null;
                    var excelData = null;
                    var arrayForExcel = ["IdEmpleado", "Nombre", "ApellidoPaterno", "ApellidoMaterno", "Puesto", "FechaNacimiento", "FechaAntiguedad", "Sexo", "Email", "TipoFuncion", "CondicionTrabajo", "GradoAcademico", "UnidadNegocio", "DivisionMarca", "AreaAgencia", "Departamento", "Subdepartamento", "EmpresaContratante", "IdResponsableRH", "NombreResponsableRH", "IdJefe", "NombreJefe", "PuestoJefe", "IdResponsableEstructura", "NombreResponsableEstructura", "RangoAntiguedad", "RangoEdad", "ESTATUS_USUARIO", "CampoNumerico_1", "CampoDeTexto_1", "CampoNumerico_2", "CampoNumerico_3", "CampoDeTexto_2", "CampoDeTexto_3"];
                    function ExportToTable(e) {
                        var tipoBD = @Session["TipoBD"];
                        if (tipoBD == 2) {
                            if (e.id == 'postedFile') {//Agregar a una BD Existente
                                arrayForExcel = ["IdEmpleado", "Nombre", "ApellidoPaterno", "ApellidoMaterno", "Puesto", "FechaNacimiento", "FechaAntiguedad", "Sexo", "Email", "TipoFuncion", "CondicionTrabajo", "GradoAcademico", "UnidadNegocio", "DivisionMarca", "AreaAgencia", "Departamento", "Subdepartamento", "EmpresaContratante", "IdResponsableRH", "NombreResponsableRH", "IdJefe", "NombreJefe", "PuestoJefe", "IdResponsableEstructura", "NombreResponsableEstructura", "RangoAntiguedad", "RangoEdad", "ESTATUS_USUARIO", "CampoNumerico_1", "CampoDeTexto_1", "CampoNumerico_2", "CampoNumerico_3", "CampoDeTexto_2", "CampoDeTexto_3"];
                            }
                            if (e.id == 'postedFile_' || e.id == 'postedFileOverride_') {//UpdateMasivoUsuarios
                                arrayForExcel = ["GetDataFromBD","Editar","IdUsuario","Password","Nombre","Apellido Paterno","Apellido Materno","Puesto","FechaNacimiento","FechaAntiguedad","Sexo","Email","TipoFuncion","CondicionTrabajo","GradoAcademico","UnidadNegocio","DivisionMarca","AreaAgencia","Departamento","Subdepartamento","Empresa contratante","IdResponsableRH","NombreResponsableRH","IdJefe","NombreJefe","puestoJefe","IdResponsableEstructura","NombreResponsableEstructura","ClaveAcceso","RangoAntiguedad","RangoEdad","EstatusEmpleado","CampoNumerico_1","CampoDeTexto_1"];
                            }
                        }
                        if (tipoBD == 1) {
                            if (e.id == 'postedFile_' || e.id == 'postedFileOverride_') {
                                arrayForExcel = ["GetDataFromBD","Editar", "IdEncuestado", "IdEmpleadoRH","Password","Nombre","Apellido Paterno","Apellido Materno","Puesto","FechaNacimiento","FechaAntiguedad","Sexo","Email","TipoFuncion","CondicionTrabajo","GradoAcademico","UnidadNegocio","DivisionMarca","AreaAgencia","Departamento","Subdepartamento","Empresa contratante","IdResponsableRH","NombreResponsableRH","IdJefe","NombreJefe","puestoJefe","IdResponsableEstructura","NombreResponsableEstructura","ClaveAcceso","RangoAntiguedad","RangoEdad"];
                            }
                            if (e.id == 'postedFile') {
                                arrayForExcel = ["IdEmpleado", "Nombre", "ApellidoPaterno", "ApellidoMaterno", "Puesto", "FechaNacimiento", "FechaAntiguedad", "Sexo", "Email", "TipoFuncion", "CondicionTrabajo", "GradoAcademico", "UnidadNegocio", "DivisionMarca", "AreaAgencia", "Departamento", "Subdepartamento", "EmpresaContratante", "IdResponsableRH", "NombreResponsableRH", "IdJefe", "NombreJefe", "PuestoJefe", "IdResponsableEstructura", "NombreResponsableEstructura", "RangoAntiguedad", "RangoEdad", "ESTATUS_USUARIO", "CampoNumerico_1", "CampoDeTexto_1", "CampoNumerico_2", "CampoNumerico_3"];
                            }
                        }
                        
                        $('#exceltable tr').remove();
                        var archivo = $('#' + e.id).val();
                        var extension = archivo.split('.')[1];
                        if (extension == 'xlsx') {
                            var xlsxflag = false; /*Flag for checking whether excel is .xls format or .xlsx format*/
                            if ($("#" + e.id).val().toLowerCase().indexOf(".xlsx") > 0) {
                                xlsxflag = true;
                            }
                            /*Checks whether the browser supports HTML5*/
                            if (typeof (FileReader) != "undefined") {
                                var reader = new FileReader();
                                reader.onload = function (e) {
                                    var data = e.target.result;
                                    /*Converts the excel data in to object*/
                                    data = new Uint8Array(data);
                                    if (xlsxflag) {
                                        var workbook = XLSX.read(data, { type: 'array' });
                                        //buffer, base64, binary, array
                                        propiertiesExcel = workbook;
                                    }
                                    else {
                                        var workbook = XLS.read(data, { type: 'binary' });
                                        propiertiesExcel = workbook;
                                    }
                                    /*Gets all the sheetnames of excel in to a variable*/
                                    var sheet_name_list = workbook.SheetNames;

                                    var cnt = 0; /*This is used for restricting the script to consider only first sheet of excel*/
                                    sheet_name_list.forEach(function (y) { /*Iterate through all sheets*/
                                        /*Convert the cell value to Json*/
                                        if (xlsxflag) {
                                            var exceljson = XLSX.utils.sheet_to_json(workbook.Sheets[y]);
                                            excelData = exceljson;
                                        }
                                        else {
                                            var exceljson = XLS.utils.sheet_to_row_object_array(workbook.Sheets[y]);
                                            excelData = exceljson;
                                            if (exceljson == null) {
                                                excelValido = false;
                                                swal('El archivo no contiene informacion para guardar', '', 'info');
                                                event.preventDefault();
                                                return false;
                                            }
                                        }
                                        if (exceljson.length > 0 && cnt == 0) {
                                            BindTable(exceljson, '#exceltable');
                                            cnt++;
                                        }
                                    });
                                    var rows = $('#exceltable tr').length;
                                    var cols = [];//31
                                    if (tipoBD == 2) {
                                        for (var i = 0; i < 34; i++) {
                                            cols.push(propiertiesExcel.Strings[i].h);
                                        }
                                    }
                                    else{
                                        for (var i = 0; i < 32; i++) {
                                            cols.push(propiertiesExcel.Strings[i].h);
                                        }
                                    }
                                    
                                    var jsonArrayCorrect = JSON.stringify(arrayForExcel);
                                    var jsonArrayInput = JSON.stringify(cols);
                                    //Validacion
                                    if (rows == 0) {
                                        excelValido = false;
                                        swal('El archivo que ha elegido no contiene informacion para importar', '', 'info');
                                        event.preventDefault();
                                        return false;
                                    }
                                    else{
                                        excelValido = true;
                                        //$('#exceltable').DataTable();
                                        $('#exceltable').hide();
                                    }

                                    if (jsonArrayCorrect != jsonArrayInput) {
                                        excelValido = false;
                                        swal('El archivo no coincide con la estrucura del layout especificada.', '', 'info');
                                        event.preventDefault();
                                        return false;
                                    }
                                    else if (rows > 0 && jsonArrayCorrect == jsonArrayInput && extension == 'xlsx') {
                                        excelValido = true;
                                        //$('#exceltable').DataTable();
                                        $('#exceltable').hide();
                                    }
                                }
                                if (xlsxflag) {/*If excel file is .xlsx extension than creates a Array Buffer from excel*/
                                    reader.readAsArrayBuffer($("#" + e.id)[0].files[0]);
                                }
                                else {
                                    reader.readAsBinaryString($("#" + e.id)[0].files[0]);
                                }
                            }
                            else {
                                swal("Your browser does not support HTML5!", "", "info");
                                event.preventDefault();
                                return false;
                            }
                        }
                        else {
                            swal("Formato de archivo no admitido", "", "info");
                            event.preventDefault();
                            return false;
                        }
                    }
                    function BindTable(jsondata, tableid) {/*Function used to convert the JSON array to Html Table*/
                        tableid = '#cuerpoTabla';
                        var columns = BindTableHeader(jsondata, tableid); /*Gets all the column headings of Excel*/
                        for (var i = 0; i < jsondata.length; i++) {
                            var row$ = $('<tr/>');
                            for (var colIndex = 0; colIndex < columns.length; colIndex++) {
                                var cellValue = jsondata[i][columns[colIndex]];
                                if (cellValue == null)
                                    cellValue = "";
                                row$.append($('<td/>').html(cellValue));
                            }
                            $(tableid).append(row$);
                        }
                    }
                    function BindTableHeader(jsondata, tableid) {/*Function used to get all column names from JSON and bind the html table header*/
                        tableid = "#filaHead";
                        var columnSet = [];
                        var headerTr$ = $('<tr/>');
                        for (var i = 0; i < jsondata.length; i++) {
                            var rowHash = jsondata[i];
                            for (var key in rowHash) {
                                if (rowHash.hasOwnProperty(key)) {
                                    if ($.inArray(key, columnSet) == -1) {/*Adding each unique column names to a variable array*/
                                        columnSet.push(key);
                                        headerTr$.append($('<th/>').html(key));
                                    }
                                }
                            }
                        }
                        $(tableid).append(headerTr$);
                        return columnSet;
                    }
                </script>


                @*modal agregar Usuario masivo*@
                <div class="wrapper-editor">
                    <div class="row d-flex justify-content-center modalWrapper">
                        <div class="modal fade addNewInputs" id="modalAddBulk" tabindex="-1" role="dialog" aria-labelledby="modalAddBulk"
                             aria-hidden="true" data-backdrop="static" data-keyboard="false">
                            <div class="modal-dialog" role="document">
                                @using (Html.BeginForm("AddToExistDatabase", "BD", FormMethod.Post, new { enctype = "multipart/form-data" }))
                                {
                                    <div class="modal-content">
                                        <div class="modal-header text-center">
                                            <h4 class="modal-title w-100 font-weight-bold text-primary ml-5">Agrega usuarios de forma masiva</h4>
                                            <button type="button" class="close text-primary" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body mx-3">
                                            <div class="md-form mb-5">
                                                <label data-error="wrong" data-success="right" for="inputName">Elige el excel con los datos cargados</label>
                                                <input onchange="ExportToTable(this)" type="file" id="postedFile" name="postedFile" class="form-control validate">
                                            </div>
                                            @*<span style="color:red; font-weight:bold" id="IdEmpleado">
                                                El Id De empleado con el que debe iniciar su layout es:
                                            </span>*@
                                        </div>
                                        @*<script src="~/scripts/jquery-3.4.1.min.js"></script>*@
                                        @*<script>
                                            $(document).ready(function () {
                                                $("select[name='myTable_length']").append(new Option("Todos los registros", "1000000"));
                                                var IdEmpleadoForNewInsert = 0;
                                                var tipoBD = @Session["TipoBD"];
                                                if (tipoBD == 1) {
                                                    $.ajax({
                                                        url: '@Url.Action("GetLastEmapleado")',
                                                        data: 1,
                                                        complete: function (Response) {
                                                            var IdForNewInsert = Response.responseJSON + 1;
                                                            IdEmpleadoForNewInsert = IdForNewInsert;
                                                            $('#IdEmpleado').append(IdEmpleadoForNewInsert);
                                                        }
                                                    });
                                                }
                                            })
                                        </script>
                                        <span id="IdEmpleado">
                                            @ViewBag.Message
                                        </span>*@
                                        <table id="exceltable" class="table table-hover table-responsive" style="display:none;">
                                            <thead id="filaHead">

                                            </thead>
                                            <tbody id="cuerpoTabla"></tbody>
                                        </table>
                                        <div class="modal-footer d-flex justify-content-center buttonAddFormWrapper">
                                            <button onclick="if(excelValido == false) { swal('Verifica el archivo que has cargado', '', 'info'); event.preventDefault() }" class="btn btn-outline-primary btn-block buttonAdd">
                                                Importar datos
                                                <i class="fas fa-plus-square ml-1"></i>
                                            </button>
                                        </div>
                                    </div>
                                }
                            </div>
                        </div>




                        <div class="modal fade addNewInputs" id="modalUpdateBulk" tabindex="-1" role="dialog" aria-labelledby="modalUpdateBulk"
                             aria-hidden="true" data-backdrop="static" data-keyboard="false">
                            <div class="modal-dialog" role="document">
                                @*@using (Html.BeginForm("UpdateUsuarios", "BD", FormMethod.Post, new { enctype = "multipart/form-data" }))
                                    {*@
                                <div class="modal-content">
                                    <div class="modal-header text-center">
                                        <h4 class="modal-title w-100 font-weight-bold text-primary ml-5">Actualiza el layout de forma masiva</h4>
                                        <button type="button" class="close text-primary" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body mx-3">
                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Elige el excel con los datos actualizados cargados</label>
                                            <input onchange="ExportToTable(this);" type="file" id="postedFile_" name="postedFile_" class="form-control validate">
                                        </div>

                                    </div>
                                    <span>
                                        @ViewBag.Message
                                    </span>
                                    <div class="modal-footer d-flex justify-content-center buttonAddFormWrapper">
                                        <button onclick="UpdateData()" class="btn btn-outline-primary btn-block buttonAdd">
                                            Importar datos
                                            <i class="fas fa-plus-square ml-1"></i>
                                        </button>
                                    </div>
                                </div>
                                @*}*@
                            </div>
                        </div>

                        <div class="modal fade addNewInputs" id="modalOverride" tabindex="-1" role="dialog" aria-labelledby="modalOverride"
                             aria-hidden="true" data-backdrop="static" data-keyboard="false">
                            <div class="modal-dialog" role="document">
                                @*@using (Html.BeginForm("UpdateUsuarios", "BD", FormMethod.Post, new { enctype = "multipart/form-data" }))
                {*@
                                <div class="modal-content">
                                    <div class="modal-header text-center">
                                        <h4 class="modal-title w-100 font-weight-bold text-primary ml-5">Sobreescribir Base de Datos</h4>
                                        <button type="button" class="close text-primary" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body mx-3">
                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Elige el excel con los datos actualizados cargados</label>
                                            <input onchange="ExportToTable(this);" type="file" id="postedFileOverride_" name="postedFileOverride_" class="form-control validate">
                                        </div>

                                    </div>
                                    <span>
                                        @ViewBag.Message
                                    </span>
                                    <div class="modal-footer d-flex justify-content-center buttonAddFormWrapper">
                                        <button onclick="Override()" class="btn btn-outline-primary btn-block buttonAdd">
                                            Sobreescribir Base de Datos
                                            <i class="fas fa-plus-square ml-1"></i>
                                        </button>
                                    </div>
                                </div>
                                @*}*@
                            </div>
                        </div>
                    </div>
                </div>


                @*//Modal edita*@
                <div class="wrapper-editor">
                    <div class="row d-flex justify-content-center modalWrapper">
                        <!--MODAL AGREGAR AREA-->
                        <div class="modal fade addNewInputs" id="modalEdit" tabindex="-1" role="dialog" aria-labelledby="modalEdit"
                             aria-hidden="true" data-backdrop="static" data-keyboard="false">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header text-center">
                                        <h4 class="modal-title w-100 font-weight-bold text-primary ml-5">Editar usuario</h4>
                                        <button type="button" class="close text-primary" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body mx-3">

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Id del usuario</label>
                                            <input placeholder="" type="text" id="inputName" disabled class="form-control validate IdUsuario">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Nombre del administrador</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate Nombre">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Apellido paterno</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate ApellidoPaterno">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Apellido materno</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate ApellidoMaterno">
                                        </div>

                                        <div hidden class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Password</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate Password">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Puesto</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate Puesto">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Fecha de nacimiento</label>
                                            <input placeholder="" type="date" id="inputName" class="form-control validate FechaNacimiento">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Fecha de antiguedad</label>
                                            <input placeholder="" type="date" id="inputName" class="form-control validate FechaAntiguedad">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputPosition">Sexo</label>
                                            <select class="form-control Sexo" id="">
                                                <option value="0">Selecciona una opcion</option>
                                                <option value="HOMBRE">HOMBRE</option>
                                                <option value="MUJER">MUJER</option>
                                            </select>
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Correo</label>
                                            <input placeholder="" type="email" id="inputName" class="form-control validate Correo">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Funcion</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate Funcion">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Condicion de trabajo</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate CondicionTrabajo">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Grado Academico</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate GradoAcademico">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Unidad de negocio</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate UNegocio">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Empresa</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate Empresa">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Area</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate Area">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Departamento</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate Departamento">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Subdepartamento</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate Subdepartamento">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Empresa contratante</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate EmpresaContratante">
                                        </div>


                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Id Responsable de RH</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate IdResponsableRH">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Nombre responsable RH</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate NombreResponsableRH">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">IdJefe</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate IdJefe">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Nombre jefe</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate NombreJefe">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Puesto del jefe</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate PuestoJefe">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">IdResponsable de estructura</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate IdResponsableEstructura">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Nombre responsable de estructura</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate NombreResponsableEstructura">
                                        </div>

                                        <div hidden class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Clave de acceso</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate ClaveAcceso">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Rango Antiguedad</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate RangoAntiguedad">
                                        </div>

                                        <div class="md-form mb-5">
                                            <label data-error="wrong" data-success="right" for="inputName">Rango Edad</label>
                                            <input placeholder="" type="text" id="inputName" class="form-control validate RangoEdad">
                                        </div>





                                        @{
                                            var TIPOdEbd = Convert.ToInt32(Session["TipoBD"]);
                                            if (TIPOdEbd == 2)
                                            {
                                                <div class="md-form mb-5">
                                                    <label data-error="wrong" data-success="right" for="inputPosition">Estatus</label>
                                                    <select class="form-control EstatusUsuario" id="">
                                                        <option value="0">Selecciona una opcion</option>
                                                        <option value="1">Activo</option>
                                                        <option value="2">Inactivo</option>
                                                    </select>
                                                </div>

                                                <div class="md-form mb-5">
                                                    <label data-error="wrong" data-success="right" for="inputName">Campo numerico 1</label>
                                                    <input placeholder="" type="text" id="inputName" class="form-control validate Numerico1">
                                                </div>

                                                <div class="md-form mb-5">
                                                    <label data-error="wrong" data-success="right" for="inputName">Campo de texto 1</label>
                                                    <input placeholder="" type="text" id="inputName" class="form-control validate Texto1">
                                                </div>

                                                <div class="md-form mb-5">
                                                    <label data-error="wrong" data-success="right" for="inputName">Campo numerico 2</label>
                                                    <input placeholder="" type="text" id="inputName" class="form-control validate Numerico2">
                                                </div>

                                                <div class="md-form mb-5">
                                                    <label data-error="wrong" data-success="right" for="inputName">Campo de texto 2</label>
                                                    <input placeholder="" type="text" id="inputName" class="form-control validate Texto2">
                                                </div>

                                                <div class="md-form mb-5">
                                                    <label data-error="wrong" data-success="right" for="inputName">Campo numerico 3</label>
                                                    <input placeholder="" type="text" id="inputName" class="form-control validate Numerico3">
                                                </div>

                                                <div class="md-form mb-5">
                                                    <label data-error="wrong" data-success="right" for="inputName">Campo de texto 3</label>
                                                    <input placeholder="" type="text" id="inputName" class="form-control validate Texto3">
                                                </div>
                                            }
                                            else
                                            {
                                                <div class="md-form mb-5">
                                                    <label data-error="wrong" data-success="right" for="inputPosition">Estatus</label>
                                                    <select class="form-control EstatusUsuario" id="">
                                                        <option value="0">Selecciona una opcion</option>
                                                        <option value="Activo">Activo</option>
                                                        <option value="Inactivo">Inactivo</option>
                                                    </select>
                                                </div>
                                            }
                                        }




                                    </div>
                                    @{
                                        if (TIPOdEbd == 2)
                                        {
                                            <div class="modal-footer d-flex justify-content-center buttonAddFormWrapper">
                                                <button onclick="postUpdate()" class="btn btn-outline-primary btn-block buttonAdd">
                                                    Guardar cambios
                                                    <i class="fas fa-plus ml-1"></i>
                                                </button>
                                            </div>
                                        }
                                        else if (TIPOdEbd == 1)
                                        {
                                            <div class="modal-footer d-flex justify-content-center buttonAddFormWrapper">
                                                <button onclick="postUpdateEmpleado()" class="btn btn-outline-primary btn-block buttonAdd">
                                                    Guardar cambios
                                                    <i class="fas fa-plus ml-1"></i>
                                                </button>
                                            </div>
                                        }
                                    }

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <style>
                    .modal-backdrop {
                        z-index: -5 !important;
                    }
                </style>


    <link href="https://cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css" rel="stylesheet" />
    <script src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.4.0/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.4.0/js/buttons.flash.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.4.0/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.4.0/js/buttons.print.min.js"></script>
    <link href="https://cdn.datatables.net/buttons/1.4.0/css/buttons.dataTables.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdn.rawgit.com/bpampuch/pdfmake/0.1.27/build/pdfmake.min.js"></script>
    <script src="https://cdn.rawgit.com/bpampuch/pdfmake/0.1.27/build/vfs_fonts.js"></script>

                <script>
                    $(document).ready(function () {
                        //$('#myTable').DataTable();
                        $('#myTable').DataTable({
                            dom: 'Bfrtip',
                            buttons: [
                                'excel'
                            ]
                        });
                        var padre = $('.buttons-excel').parent();//Datatable 3
                        padre[0].id = 'divbtnDatatable'
                        $(padre[0]).attr('data-sort', '3');//3
                        var span = $('.buttons-excel').find('span');
                        span[0].textContent = "Descargar BD";
                        $('.buttons-excel').addClass('btn btn-secondary btn-action btn-sm ml-1');
                        $('.buttons-excel').append('<i class="fas fa-database ml-1"></i>');
                        $('.buttons-excel').removeClass('dt-button buttons-excel buttons-html5');

                        //Override 5
                        $("#myTable_wrapper").prepend(
                            '<div data-sort="5" class="dt-buttons ml-1"><a id="exportar" style="" href="#" class="btn btn-secondary btn-action btn-sm" data-toggle="modal" data-target="#modalOverride">Sobreescribir BD<i class="fas fa-pencil-alt ml-1"></i></a></div>'
                        );
                        //UpdateBulk ok 4
                        $("#myTable_wrapper").prepend(
                            '<div data-sort="4" class="dt-buttons ml-1"><a id="UpdateBulk" style="color:white" class="btn btn-secondary btn-action btn-sm" data-toggle="modal" data-target="#modalUpdateBulk">Actualizar BD<i class="fas fa-sync ml-1"></i></a></div>'
                        );

                        //Descarga BD Datatable
                        var x = $('#divbtnDatatable').detach();
                        $("#myTable_wrapper").prepend(x);


                        //Addusr 2
                        $("#myTable_wrapper").prepend(
                            '<div data-sort="2" class="dt-buttons ml-1"><a href="" class="btn btn-secondary btn-action btn-sm" data-toggle="modal" data-target="#modalAddBulk">Agregar Usuarios<i class="fas fa-plus-square ml-1"></i></a></div>'
                        );
                        //Layout 1
                        var tipoBD = @Session["TipoBD"];
                        if (tipoBD == 1) {
                            $("#myTable_wrapper").prepend(
                            '<div data-sort="1" class="dt-buttons ml-1"><a id="DownloadLayout" style="" href="@Url.Action("DownloadLayoutClimaLaboral")" class="btn btn-secondary btn-action btn-sm" data-toggle="" data-target="">Descargar Layout<i class="fas fa-download ml-1"></i></a</div>'
                            );
                        }
                        else{
                            $("#myTable_wrapper").prepend(
                            '<div data-sort="1" class="dt-buttons ml-1"><a id="DownloadLayout" style="" href="@Url.Action("DownloadLayout")" class="btn btn-secondary btn-action btn-sm" data-toggle="" data-target="">Descargar Layout<i class="fas fa-download ml-1"></i></a</div>'
                        );
                        }



                        //$('div').sort(function (a, b) {
                        //    var contentA =parseInt( $(a).attr('data-sort'));
                        //    var contentB =parseInt( $(b).attr('data-sort'));
                        //    return (contentA < contentB) ? -1 : (contentA > contentB) ? 1 : 0;
                        //})


                    });
                </script>
                <script>
                    var tableToExcel = (function () {
                        var uri = 'data:application/vnd.ms-excel;base64,'
                          , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><meta http-equiv="content-type" content="text/plain; charset=UTF-8"/></head><body><table>{table}</table></body></html>'
                          , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
                          , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
                        return function (table, name) {
                            if (!table.nodeType) table = document.getElementById(table)
                            var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }
                            $("select[name='myTable_length']").val('10');
                            $("select[name='myTable_length']").trigger('change');
                            window.location.href = uri + base64(format(template, ctx))
                        }
                    })()
                </script>
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
                <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>
                <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

                <script>
                    function UpdateData() {
                        //Send file

                        swal ({
                            title: "Procesando...",
                            text: "Espere...",
                            imageUrl: "",
                            icon: "/images/load.gif",
                            showConfirmButton: false,
                            allowOutsideClick: false
                        });
                        $('.swal-icon').addClass('load');
                        $('.load').css('width', '25%');
                        $('.load').css('height', '25%');
                        $('swal-button-container').css('display', 'none');

                        var formData = new FormData();
                        var totalFiles = document.getElementById("postedFile_").files.length;

                        var file = document.getElementById("postedFile_").files[0];
                        formData.append("postedFile_", file);

                        if (@Session["TipoBD"] == 2) {
                            $.ajax({
                                type: 'POST',
                                url: '@Url.Action("UpdateUsuarios", "BD")',
                                data: formData,
                                dataType: 'json',
                                contentType: false,
                                processData: false,
                                complete: function (Response) {
                                    if(Response.responseJSON == "success"){
                                        swal({
                                            title: "La información se actualizó exitosamente",
                                            text: "",
                                            type: "success",
                                            icon: "success",
                                        }).then(function () {
                                            window.location.reload(true);
                                        });
                                    }
                                    else if (Response.responseJSON == "ERROR") {
                                        swal({
                                            title: "Hubo un error al actualizar la información",
                                            text: "",
                                            type: "error",
                                            icon: "error",
                                        }).then(function () {
                                            window.location.reload(true);
                                        });
                                    }
                                }
                            });
                        }
                        else{
                            $.ajax({
                                type: 'POST',
                                url: '@Url.Action("UpdateEmpleadosBulk", "BD")',
                                data: formData,
                                dataType: 'json',
                                contentType: false,
                                processData: false,
                                complete: function (Response) {
                                    if(Response.responseJSON == "success"){
                                        swal({
                                            title: "La información se actualizó exitosamente",
                                            text: "",
                                            type: "success",
                                            icon: "success",
                                        }).then(function () {
                                            window.location.reload(true);
                                        });
                                    }
                                    else if (Response.responseJSON == "ERROR") {
                                        swal({
                                            title: "Hubo un error al actualizar la información",
                                            text: "",
                                            type: "error",
                                            icon: "error",
                                        }).then(function () {
                                            window.location.reload(true);
                                        });
                                    }
                                }
                            });
                        }

                        

                    }
                </script>
                <script>
                    function GetUpdate(IdUsuario) {
                        //alert(IdUsuario);
                        let model = { idUsuario: IdUsuario };

                        $.ajax({
                            url: '@Url.Action("GetUsuarioById", "BD")',
                            data: model,
                            success: function (Response) {
                                console.log(Response);
                                var nacimiento = Response.dateNacim.replace('/', '-');
                                var antig = Response.dateAntig.replace('/', '-');
                                nacimiento = nacimiento.replace('/', '-');
                                antig = antig.replace('/', '-');

                                //Set Data
                                $('.IdUsuario').val(Response.IdUsuario);
                                $('.Nombre').val(Response.Nombre);
                                $('.ApellidoPaterno').val(Response.ApellidoPaterno);
                                $('.ApellidoMaterno').val(Response.ApellidoMaterno);
                                $('.Password').val(Response.Password);
                                $('.Puesto').val(Response.Puesto);
                                $('.FechaNacimiento').val(nacimiento);
                                $('.FechaAntiguedad').val(antig);
                                if (Response.Sexo == undefined || Response.Sexo == null) {
                                    $('.Sexo').val(0);
                                }
                                else{
                                    $('.Sexo').val(Response.Sexo);
                                }

                                $('.Correo').val(Response.Email);
                                $('.Funcion').val(Response.TipoFuncion);
                                $('.CondicionTrabajo').val(Response.CondicionTrabajo);
                                $('.GradoAcademico').val(Response.GradoAcademico);
                                $('.UNegocio').val(Response.UnidadNegocio);
                                $('.Empresa').val(Response.DivisionMarca);
                                $('.Area').val(Response.AreaAgencia);
                                $('.Departamento').val(Response.Departamento);
                                $('.Subdepartamento').val(Response.Subdepartamento);
                                $('.EmpresaContratante').val(Response.EmpresaContratante);
                                $('.IdResponsableRH').val(Response.IdResponsableRH);
                                $('.NombreResponsableRH').val(Response.NombreResponsableRH);
                                $('.IdJefe').val(Response.IdJefe);
                                $('.NombreJefe').val(Response.NombreJefe);
                                $('.PuestoJefe').val(Response.PuestoJefe);
                                $('.IdResponsableEstructura').val(Response.IdRespinsableEstructura);
                                $('.NombreResponsableEstructura').val(Response.NombreResponsableEstructura);
                                $('.ClaveAcceso').val(Response.ClaveAcceso);
                                $('.RangoAntiguedad').val(Response.RangoAntiguedad);
                                $('.RangoEdad').val(Response.RangoEdad);
                                $('.EstatusUsuario').val(Response.TipoEstatus.IdEstatus);
                                $('.Numerico1').val(Response.CampoNumerico_1);
                                $('.Numerico2').val(Response.CampoNumerico_2);
                                $('.Numerico3').val(Response.CampoNumerico_3);
                                $('.Texto1').val(Response.CampoDeTexto_1);
                                $('.Texto2').val(Response.CampoDeTexto_2);
                                $('.Texto3').val(Response.CampoDeTexto_3);
                            }
                        });
                    }

                    function postUpdate() {
                        var IdUsuario = $('.IdUsuario').val();
                        var Nombre = $('.Nombre').val();
                        var ApellidoPaterno = $('.ApellidoPaterno').val();
                        var ApellidoMaterno = $('.ApellidoMaterno').val();
                        var Password = $('.Password').val();
                        var Puesto = $('.Puesto').val();
                        var FechaNacimiento = $('.FechaNacimiento').val();
                        var FechaAntiguedad = $('.FechaAntiguedad').val();
                        var Sexo = $('.Sexo').val();
                        var Correo = $('.Correo').val();
                        var Funcion = $('.Funcion').val();
                        var CondicionTrabajo = $('.CondicionTrabajo').val();
                        var GradoAcademico = $('.GradoAcademico').val();
                        var UnidadNegocio = $('.UNegocio').val();
                        var DivisonMarca = $('.Empresa').val();
                        var AreaAgencia = $('.Area').val();
                        var Departamento = $('.Departamento').val();
                        var Subdepartamento = $('.Subdepartamento').val();
                        var EmpresaContratante = $('.EmpresaContratante').val();
                        var IdResponsableRH = $('.IdResponsableRH').val();
                        var NombreResponsableRH = $('.NombreResponsableRH').val();
                        var IdJefe = $('.IdJefe').val();
                        var NombreJefe = $('.NombreJefe').val();
                        var PuestoJefe = $('.PuestoJefe').val();
                        var IdResponsableEstructura = $('.IdResponsableEstructura').val();
                        var NombreResponsableEstructura = $('.NombreResponsableEstructura').val();
                        var ClaveAcceso = $('.ClaveAcceso').val();
                        var RangoAntiguedad = $('.RangoAntiguedad').val();
                        var RangoEdad = $('.RangoEdad').val();
                        var IdEstatus = $('.EstatusUsuario').val();
                        //$('.EstatusUsuario').text();
                        if (IdEstatus == 0)
                            IdEstatus = "1";

                        var numerico1 = $('.Numerico1').val();
                        var numerico2 = $('.Numerico2').val();
                        var numerico3 = $('.Numerico3').val();
                        var texto1 = $('.Texto1').val();
                        var texto2 = $('.Texto2').val();
                        var texto3 = $('.Texto3').val();

                        let model = {
                            idUsuario: IdUsuario,
                            nombre: Nombre,
                            apellidoPaterno: ApellidoPaterno,
                            apellidoMaterno: ApellidoMaterno,
                            password: Password,
                            puesto: Puesto,
                            fechaNacimiento: FechaNacimiento,
                            fechaAntiguedad: FechaAntiguedad,
                            sexo: Sexo,
                            email: Correo,
                            tipoFuncion: Funcion,
                            CondicionTrabajo: CondicionTrabajo,
                            GradoAcademico: GradoAcademico,
                            UnidadNegocio: UnidadNegocio,
                            DivisionMarca: DivisonMarca,
                            AreaAgencia: AreaAgencia,
                            Departamento: Departamento,
                            Subdepartamento: Subdepartamento,
                            EmpresaContratante: EmpresaContratante,
                            IdResponsableRH: IdResponsableRH,
                            NombreResponsableRH: NombreResponsableRH,
                            IdJefe: IdJefe,
                            NombreJefe: NombreJefe,
                            PuestoJefe: PuestoJefe,
                            IdRespinsableEstructura: IdResponsableEstructura,
                            NombreResponsableEstructura: NombreResponsableEstructura,
                            ClaveAcceso: ClaveAcceso,
                            RangoAntiguedad: RangoAntiguedad,
                            RangoEdad: RangoEdad,
                            IdEstatus: IdEstatus,
                            CampoNumerico_2: numerico2,
                            CampoNumerico_1: numerico1,

                            CampoNumerico_3: numerico3,
                            CampoDeTexto_1: texto1,
                            CampoDeTexto_2: texto2,
                            CampoDeTexto_3: texto3
                        };
                        //perfilD4U: { IdPerfil: IdPerfil },
                        var obj = JSON.stringify(model);

                        $.ajax({
                            type: 'POST',
                            url: '@Url.Action("UpdateOneUsuario", "BD")',
                            data: model,
                            complete: function (Response) {
                                if(Response.responseJSON == 'success'){
                                    swal({
                                        title: "La información se actualizó exitosamente",
                                        text: "",
                                        type: "success",
                                        icon: "success",
                                    }).then(function () {
                                        window.location.reload(true);
                                    });
                                }
                                else {
                                    swal({
                                        title: "Ocurrió un error al actualizar la información",
                                        text: "",
                                        type: "error",
                                        icon: "error",
                                    }).then(function () {
                                        window.location.reload(true);
                                    });
                                }
                            }
                        });


                    }
                </script>
                <script>
                    function GetUpdateEmpleado(IdEmpleado) {
                        //alert(IdUsuario);
                        let model = { IdEmpleado: IdEmpleado };

                        $.ajax({
                            url: '@Url.Action("GetEmpleadoById", "BD")',
                            data: model,
                            success: function (Response) {
                                console.log(Response);
                                var nacimiento = Response.dateNacim.replace('/', '-');
                                var antig = Response.dateAntig.replace('/', '-');
                                nacimiento = nacimiento.replace('/', '-');
                                antig = antig.replace('/', '-');

                                //Set Data
                                $('.IdUsuario').val(Response.IdEmpleado);
                                $('.Nombre').val(Response.Nombre);
                                $('.ApellidoPaterno').val(Response.ApellidoPaterno);
                                $('.ApellidoMaterno').val(Response.ApellidoMaterno);
                                $('.Password').val(Response.ClavesAcceso.ClaveAcceso);
                                $('.Puesto').val(Response.Puesto);
                                $('.FechaNacimiento').val(nacimiento);
                                $('.FechaAntiguedad').val(antig);
                                $('.Sexo').val(Response.Sexo);
                                $('.Correo').val(Response.Correo);
                                $('.Funcion').val(Response.TipoFuncion);
                                $('.CondicionTrabajo').val(Response.CondicionTrabajo);
                                $('.GradoAcademico').val(Response.GradoAcademico);
                                $('.UNegocio').val(Response.UnidadNegocio);
                                $('.Empresa').val(Response.DivisonMarca);
                                $('.Area').val(Response.AreaAgencia);
                                $('.Departamento').val(Response.Depto);
                                $('.Subdepartamento').val(Response.Subdpto);
                                $('.EmpresaContratante').val(Response.EmpresaContratante);
                                $('.IdResponsableRH').val(Response.IdResponsableRH);
                                $('.NombreResponsableRH').val(Response.NombreResponsableRH);
                                $('.IdJefe').val(Response.IdJefe);
                                $('.NombreJefe').val(Response.NombreJefe);
                                $('.PuestoJefe').val(Response.PuestoJefe);
                                $('.IdResponsableEstructura').val(Response.IdRespinsableEstructura);
                                $('.NombreResponsableEstructura').val(Response.NombreResponsableEstructura);
                                $('.ClaveAcceso').val(Response.ClavesAcceso.ClaveAcceso);
                                $('.RangoAntiguedad').val(Response.RangoAntiguedad);
                                $('.RangoEdad').val(Response.RangoEdad);
                                $('.EstatusUsuario').val(Response.EstatusEmpleado);

                            }
                        });
                    }

                    function postUpdateEmpleado() {
                        var IdEmpleado = $('.IdUsuario').val();
                        var Nombre = $('.Nombre').val();
                        var ApellidoPaterno = $('.ApellidoPaterno').val();
                        var ApellidoMaterno = $('.ApellidoMaterno').val();
                        var Password = $('.Password').val();
                        var Puesto = $('.Puesto').val();
                        var FechaNacimiento = $('.FechaNacimiento').val();
                        var FechaAntiguedad = $('.FechaAntiguedad').val();
                        var Sexo = $('.Sexo').val();
                        var Correo = $('.Correo').val();
                        var Funcion = $('.Funcion').val();
                        var CondicionTrabajo = $('.CondicionTrabajo').val();
                        var GradoAcademico = $('.GradoAcademico').val();
                        var UnidadNegocio = $('.UNegocio').val();
                        var DivisonMarca = $('.Empresa').val();
                        var AreaAgencia = $('.Area').val();
                        var Departamento = $('.Departamento').val();
                        var Subdepartamento = $('.Subdepartamento').val();
                        var EmpresaContratante = $('.EmpresaContratante').val();
                        var IdResponsableRH = $('.IdResponsableRH').val();
                        var NombreResponsableRH = $('.NombreResponsableRH').val();
                        var IdJefe = $('.IdJefe').val();
                        var NombreJefe = $('.NombreJefe').val();
                        var PuestoJefe = $('.PuestoJefe').val();
                        var IdResponsableEstructura = $('.IdResponsableEstructura').val();
                        var NombreResponsableEstructura = $('.NombreResponsableEstructura').val();
                        var ClaveAcceso = $('.ClaveAcceso').val();
                        var RangoAntiguedad = $('.RangoAntiguedad').val();
                        var RangoEdad = $('.RangoEdad').val();
                        var IdEstatus = $( ".EstatusUsuario option:selected" ).val();
                        //$('.EstatusUsuario').text();
                        if (IdEstatus == 0)
                            IdEstatus = "Activo";


                        let model = {
                            idempleado: IdEmpleado,
                            nombre: Nombre,
                            apellidoPaterno: ApellidoPaterno,
                            apellidoMaterno: ApellidoMaterno,
                            password: Password,
                            puesto: Puesto,
                            FechaNaciemiento: FechaNacimiento,
                            fechaAntiguedad: FechaAntiguedad,
                            sexo: Sexo,
                            correo: Correo,
                            tipoFuncion: Funcion,
                            CondicionTrabajo: CondicionTrabajo,
                            GradoAcademico: GradoAcademico,
                            UnidadNegocio: UnidadNegocio,
                            DivisonMarca: DivisonMarca,
                            AreaAgencia: AreaAgencia,
                            Depto: Departamento,
                            Subdepto: Subdepartamento,
                            EmpresaContratante: EmpresaContratante,
                            IdResponsableRH: IdResponsableRH,
                            NombreResponsableRH: NombreResponsableRH,
                            IdJefe: IdJefe,
                            NombreJefe: NombreJefe,
                            PuestoJefe: PuestoJefe,
                            IdRespinsableEstructura: IdResponsableEstructura,
                            NombreResponsableEstructura: NombreResponsableEstructura,
                            ClavesAcceso: { ClaveAcceso: ClaveAcceso} ,
                            RangoAntiguedad: RangoAntiguedad,
                            RangoEdad: RangoEdad,
                            EstatusEmpleado: IdEstatus

                        };
                        //perfilD4U: { IdPerfil: IdPerfil },
                        var obj = JSON.stringify(model);

                        $.ajax({
                            type: 'POST',
                            url: '@Url.Action("UpdateOneEmpleado", "BD")',
                            data: model,
                            complete: function (Response) {
                                if(Response.responseJSON == 'success'){
                                    swal({
                                        title: "La información se actualizó exitosamente",
                                        text: "",
                                        type: "success",
                                        icon: "success",
                                    }).then(function () {
                                        window.location.reload(true);
                                    });
                                }
                                else {
                                    swal({
                                        title: "Ocurrió un error al actualizar la información",
                                        text: "",
                                        type: "error",
                                        icon: "error",
                                    }).then(function () {
                                        window.location.reload(true);
                                    });
                                }
                            }
                        });


                    }
                    function getAll() {
                        $("select[name='myTable_length']").val('1000000');
                        $("select[name='myTable_length']").trigger('change');
                    }
                    function Override() {
                        var formData = new FormData();
                        var totalFiles = document.getElementById("postedFileOverride_").files.length;

                        var file = document.getElementById("postedFileOverride_").files[0];
                        formData.append("postedFileOverride_", file);

                        var tipoBD = @Session["TipoBD"];

                        if (tipoBD == 2) {
                            $.ajax({
                                type: 'POST',
                                url: '@Url.Action("OverwriteDatabaseUsuarios", "BD")',
                                data: formData,
                                dataType: 'json',
                                contentType: false,
                                processData: false,
                                complete: function (Response) {
                                    if(Response.responseJSON == "success"){
                                        swal({
                                            title: "La información se actualizó exitosamente",
                                            text: "",
                                            type: "success",
                                            icon: "success",
                                        }).then(function () {
                                            window.location.reload(true);
                                        });
                                    }
                                    else if (Response.responseJSON == "ERROR") {
                                        swal({
                                            title: "Hubo un error al actualizar la información",
                                            text: "",
                                            type: "error",
                                            icon: "error",
                                        }).then(function () {
                                            window.location.reload(true);
                                        });
                                    }
                                }
                            });
                        }
                        else{
                            $.ajax({
                                type: 'POST',
                                url: '@Url.Action("OverwriteDatabaseEmpleado", "BD")',
                                data: formData,
                                dataType: 'json',
                                contentType: false,
                                processData: false,
                                complete: function (Response) {
                                    if(Response.responseJSON == "success"){
                                        swal({
                                            title: "La información se actualizó exitosamente",
                                            text: "",
                                            type: "success",
                                            icon: "success",
                                        }).then(function () {
                                            window.location.reload(true);
                                        });
                                    }
                                    else if (Response.responseJSON == "ERROR") {
                                        swal({
                                            title: "Hubo un error al actualizar la información",
                                            text: "",
                                            type: "error",
                                            icon: "error",
                                        }).then(function () {
                                            window.location.reload(true);
                                        });
                                    }
                                }
                            });
                        }
                        
                    }
                </script>
                @*<script src="~/scripts/jquery-1.8.3.min.js"></script>*@
                <style>
                    #modalEdit, #modalAdd ,#modalAddSubCat,#modalAddCat{
                        background-color: #000000b8;
                            overflow: auto;
                    }
                </style>        
                 
    </body>
</html>
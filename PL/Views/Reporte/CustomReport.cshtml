
@{
    ViewBag.Title = "CustomReport";
    Layout = "~/Views/Admin/Contenido.cshtml";
    var progreso = 0.00;
    try
    {
        List<object> data = (List<object>)HttpRuntime.Cache.Get("ReporteClimaLaboralTurismo");
        var length = data.Count;
        progreso = (length / 285) * 100;
    }
    catch (Exception)
    {
        progreso = 0;
    }
}

<section id="page-title">
    <div class="container-fluid px-lg-5">
        <img src="~/img/icon-reports.png" class="img-fluid">
        <h1 class="title-page-survey">
            Reporte / <span>Administrar</span>
        </h1>
    </div><!--.container-fluid-->
</section>

<section class="" id="content">
    <p id="" style="color:red; padding-left:30px;"><strong> </strong></p>
    <div class="container-fluid px-lg-5">
        <div class="row">
            <div class="col-lg-8 offset-lg-2">
                <ul class="nav nav-tabs mb-4" id="tabSurvey" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="prev-tab" data-toggle="tab" href="#prev" role="tab" aria-controls="prev" aria-selected="false">Configuración</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" id="manag-tab" onclick="" data-toggle="tab" href="#manag" role="tab" aria-controls="manag" aria-selected="false">Estatus de los reportes</a>
                    </li>
                </ul>

                <div class="tab-content" id="tabSurveyContent">
                    <div class="tab-pane fade active show" id="prev" role="tabpanel" aria-labelledby="prev-tab">
                        <div class="section-survey shadow-sm animated fadeInUp">
                            <div class="body-survey">
                                <div class="row">
                                    <div class="col-md-6 col-lg-6 col-sm-6 col-xs-6">
                                        <h3>
                                            Administra la configuracion de tu reporte para clima laboral
                                        </h3>
                                        <div class="form-horizontal">
                                            <div class="form-group">
                                                <p>Elige una unidad de negocio</p>
                                                <div class="col-md-6 col-xl-6 col-6 col-sm-12">
                                                    <select class="form-control" id="UnidadNegocio"></select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-horizontal">
                                            <div class="form-group">
                                                @*<p>Elige una unidad de negocio</p>
                                                <div class="col-md-6 col-xl-6 col-6 col-sm-12">
                                                    <select id="enfoque" style="margin-top:20px;" class="form-control">
                                                        <option value="0">Selecciona un enfoque</option>
                                                        <option value="1">Enfoque empresa</option>
                                                        <option value="2">Enfoque área</option>
                                                    </select>
                                                </div>*@
                                            </div>
                                            <div class="form-horizontal" style="display:none;">
                                                <div class="form-group">
                                                    <table style="width:100%" @*onclick="tableToExcel('myTable', 'Reporte ClimaLaboral')"*@ id="myTable" class="table table-responsive table-bordered" border="1">
                                                        <thead id="headTable" style="font-weight:bold">
                                                            <!--Inicio-->
                                                            <tr id="Encabezado">
                                                                <th rowspan="2" colspan="2">Clima Laboral Turismo 2020</th>
                                                                <th id="resultadosGenerales" colspan="1"><strong>RESULTADOS GENERALES</strong></th>
                                                                <th colspan="2"><strong>GENERO</strong></th>
                                                                <th id="funcion"><strong>FUNCION</strong></th>
                                                                <th id="condicionTrabajo"><strong>CONDICION TRABAJO</strong></th>
                                                                <th id="gradoAcademico"><strong>GRADO ACADEMICO</strong></th>
                                                                <th id="Antiguedad"><strong>ANTIGUEDAD</strong></th>
                                                                <th id="rangoEdad"><strong>RANGOEDAD</strong></th>
                                                            </tr>
                                                            <!--segunda fila-->
                                                            <tr id="mergeFuncion">
                                                                <th id="cellUNeg"><strong></strong></th>
                                                                @*<th><strong>Turismo 2019</strong></th>
                            <th><strong>Turismo 2018</strong></th>*@
                                                                <th><strong>Gene=>Masculino</strong></th>
                                                                <th><strong>Gene=>Femenino</strong></th>
                                                                @*pegar funciones*@
                                                                @*pegar condicionTrabajo*@
                                                                @*pegar gradoAcademico*@
                                                                @*pegar antiguedad*@
                                                                @*pegar rangoedad*@
                                                                @*PEGAR estructura*@
                                                            </tr>
                                                            <tr id="pegarTotalColumnasForEsperadas">
                                                                <th rowspan="2"><strong>Categorias</strong></th>
                                                                <th><strong>Esperadas</strong></th>
                                                                <!--Pegar lo siguiente por cada columna que se haga-->
                                                                @*<th><strong>data</strong></th>*@

                                                            </tr>
                                                            <tr id="pegarTotalColumnasForContestadas">
                                                                <th><strong>Contestadas</strong></th>
                                                            </tr>
                                                            <tr id="mergeQuestionsCredibilidads" style="">
                                                                <th id="CategoriaCredibilidad" rowspan="14"><strong>CREEDIBILIDAD</strong></th>
                                                            </tr>
                                                            <tr class="preg1" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes comunican claramente sus expectativas</strong></th></tr>
                                                            <tr class="preg2" style="font-size:5px;"><th class="text-center" scope="col"><strong>Puedo hacer a los jefes cualquier pregunta razonable y recibir una respuesta clara</strong></th></tr>
                                                            <tr class="preg3" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes son accesibles y es fácil hablar con ellos</strong></th></tr>
                                                            <tr class="preg4" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes me mantienen informado acerca de asuntos y cambios importantes</strong></th></tr>
                                                            <tr class="preg5" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes tienen una visión clara de hacia dónde va la organización y de cómo lograrlo</strong></th></tr>
                                                            <tr class="preg6" style="font-size:5px;"><th class="text-center" scope="col"><strong>Aquí a la gente se le delegan responsabilidades</strong></th></tr>
                                                            <tr class="preg7" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes cumplen sus promesa</strong></th></tr>
                                                            <tr class="preg8" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los Los jefes manejan el negocio de forma competente</strong></th></tr>
                                                            <tr class="preg9" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes dirigen el negocio de una manera honesta y ética</strong></th></tr>
                                                            <tr class="preg10" style="font-size:5px;"><th class="text-center" scope="col"><strong>Las palabras de los jefes coinciden con sus acciones</strong></th></tr>
                                                            <tr class="preg11" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes asignan y coordinan bien al personal</strong></th></tr>
                                                            <tr class="preg12" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes confían que los colaboradores hacen un buen trabajo sin supervisarlos continuamente</strong></th></tr>
                                                            <tr class="preg13" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes contratan gente de acuerdo a las necesidades de la empresa</strong></th></tr>
                                                            @*pegar 13 preguntas de creedibilidad*@
                                                            <!--End-->
                                                        </thead>
                                                        <tbody>
                                                            <tr id="mergeQuestionsImparcialidadd">
                                                                <td id="CategoriaImparcialidad" rowspan="12"><strong>IMPARCIALIDAD</strong></td>
                                                            </tr>
                                                            <tr class="preg14" style="font-size:5px;"><th class="text-center" scope="col"><strong>Todos tenemos la oportunidad de ser reconocidos por nuestro trabajo</strong></th></tr>
                                                            <tr class="preg15" style="font-size:5px;"><th class="text-center" scope="col"><strong>A las personas se les paga de acuerdo al trabajo que realizan</strong></th></tr>
                                                            <tr class="preg16" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes evitan tener empleados favoritos</strong></th></tr>
                                                            <tr class="preg17" style="font-size:5px;"><th class="text-center" scope="col"><strong>La gente es tratada justamente sin importar su edad</strong></th></tr>
                                                            <tr class="preg18" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los ascensos se dan a quienes más los merecen</strong></th></tr>
                                                            <tr class="preg19" style="font-size:5px;"><th class="text-center" scope="col"><strong>La gente es tratada justamente sin importar su raza</strong></th></tr>
                                                            <tr class="preg20" style="font-size:5px;"><th class="text-center" scope="col"><strong>La gente es tratada justamente sin importar su sexo</strong></th></tr>
                                                            <tr class="preg21" style="font-size:5px;"><th class="text-center" scope="col"><strong>Aquí evitamos hablar mal de las personas para obtener un beneficio personal</strong></th></tr>
                                                            <tr class="preg22" style="font-size:5px;"><th class="text-center" scope="col"><strong>La gente es tratada justamente sin importar su preferencia sexual</strong></th></tr>
                                                            <tr class="preg23" style="font-size:5px;"><th class="text-center" scope="col"><strong>Si soy tratado injustamente, sé que tendré oportunidad de ser escuchado y recibir un trato justo</strong></th></tr>
                                                            <tr class="preg24" style="font-size:5px;"><th class="text-center" scope="col"><strong>Me tratan bien independientemente de mi posición en la empresa</strong></th></tr>


                                                            @*pegar 13 preguntas de imparcialidad*@

                                                            <tr id="mergeQuestionsOrgullOo">
                                                                <td id="CategoriaOrgullo" rowspan="8"><strong>ORGULLO</strong></td>
                                                            </tr>
                                                            <tr class="preg25" style="font-size:5px;"><th class="text-center" scope="col"><strong>Las personas están dispuestas a hacer un esfuerzo extra para realizar el trabajo</strong></th></tr>
                                                            <tr class="preg26" style="font-size:5px;"><th class="text-center" scope="col"><strong>Mi trabajo tiene un significado especial; para mí éste no es “sólo un trabajo”</strong></th></tr>
                                                            <tr class="preg27" style="font-size:5px;"><th class="text-center" scope="col"><strong>Cuando veo lo que logramos, me siento orgulloso</strong></th></tr>
                                                            <tr class="preg28" style="font-size:5px;"><th class="text-center" scope="col"><strong>A la gente le gusta venir a trabajar aquí</strong></th></tr>
                                                            <tr class="preg29" style="font-size:5px;"><th class="text-center" scope="col"><strong>Estoy orgulloso de decirle a otros que trabajo aquí</strong></th></tr>
                                                            <tr class="preg30" style="font-size:5px;"><th class="text-center" scope="col"><strong>Deseo trabajar aquí por un largo tiempo</strong></th></tr>
                                                            <tr class="preg31" style="font-size:5px;"><th class="text-center" scope="col"><strong>Siento que mi participación hace una diferencia en la organización</strong></th></tr>
                                                            @*pegar 13 preguntas de orgullo*@

                                                            <tr id="mergeQuestionsGestalstt">
                                                                <td id="CategoriaGestalt" rowspan="7"><strong>GESTALT</strong></td>
                                                            </tr>
                                                            <tr class="preg32" style="font-size:5px;"><th class="text-center" scope="col"><strong>Aquí se percibe un ambiente de excelencia, innovación, integridad, pasión y colaboració</strong></th></tr>
                                                            <tr class="preg33" style="font-size:5px;"><th class="text-center" scope="col"><strong>En esta empresa existen buenas oportunidades de crecimiento</strong></th></tr>
                                                            <tr class="preg34" style="font-size:5px;"><th class="text-center" scope="col"><strong>La gente conoce los objetivos y metas de su trabajo</strong></th></tr>
                                                            <tr class="preg35" style="font-size:5px;"><th class="text-center" scope="col"><strong>Se evalúa el desempeño de la gente de manera justa</strong></th></tr>
                                                            <tr class="preg36" style="font-size:5px;"><th class="text-center" scope="col"><strong>Tomando todo en consideración, yo diría que este es un excelente lugar donde trabajar</strong></th></tr>
                                                            <tr class="preg37" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes promueven el trabajo en equipo</strong></th></tr>
                                                            @*pegar 13 preguntas de Gestalt*@

                                                            <tr id="mergeQuestionsCompañerismos">
                                                                <td id="CategoriaCompañerismo" rowspan="8"><strong>COMPAÑERISMO</strong></td>
                                                            </tr>
                                                            <tr class="preg38" style="font-size:5px;"><th class="text-center" scope="col"><strong>Este es un lugar amigable para trabajar</strong></th></tr>
                                                            <tr class="preg39" style="font-size:5px;"><th class="text-center" scope="col"><strong>Puedo contar con la ayuda de las personas</strong></th></tr>
                                                            <tr class="preg40" style="font-size:5px;"><th class="text-center" scope="col"><strong>Cuando las personas cambian de funciones o área, se les hace sentir como en casa</strong></th></tr>
                                                            <tr class="preg41" style="font-size:5px;"><th class="text-center" scope="col"><strong>Aquí las personas se preocupan por los demás</strong></th></tr>
                                                            <tr class="preg42" style="font-size:5px;"><th class="text-center" scope="col"><strong>Aquí las personas tienen un sentido de equipo</strong></th></tr>
                                                            <tr class="preg43" style="font-size:5px;"><th class="text-center" scope="col"><strong>Estamos todos juntos en esto</strong></th></tr>
                                                            <tr class="preg44" style="font-size:5px;"><th class="text-center" scope="col"><strong>Cuando ingresas a la compañía se te hace sentir bienvenido</strong></th></tr>
                                                            @*pegar 13 preguntas de compañerismo*@
                                                            @*<tr id="preg37" style="font-size:5px;"><th class="text-center" scope="col"><strong></strong></th></tr>*@
                                                            <tr id="mergeQuestionsRespetos">
                                                                <td id="CategoriaRespeto" rowspan="13"><strong>RESPETO</strong></td>
                                                            </tr>
                                                            <tr class="preg45" style="font-size:5px;"><th class="text-center" scope="col"><strong>Me dan los recursos y herramientas necesarias para hacer mi trabajo</strong></th></tr>
                                                            <tr class="preg46" style="font-size:5px;"><th class="text-center" scope="col"><strong>Este es un lugar físicamente seguro en donde trabajar</strong></th></tr>
                                                            <tr class="preg47" style="font-size:5px;"><th class="text-center" scope="col"><strong>Me ofrecen capacitación u otro tipo de desarrollo para apoyar mi crecimiento profesional</strong></th></tr>
                                                            <tr class="preg48" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes reconocen el trabajo bien hecho y el esfuerzo extra</strong></th></tr>
                                                            <tr class="preg49" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes reconocen que pueden cometerse errores involuntarios al hacer el trabajo</strong></th></tr>
                                                            <tr class="preg50" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes fomentan y responden genuinamente a nuestras sugerencias e ideas</strong></th></tr>
                                                            <tr class="preg51" style="font-size:5px;"><th class="text-center" scope="col"><strong>Aquí se respeta la forma de ser de las personas</strong></th></tr>
                                                            <tr class="preg52" style="font-size:5px;"><th class="text-center" scope="col"><strong>Las instalaciones contribuyen a un buen ambiente de trabajo</strong></th></tr>
                                                            <tr class="preg53" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes demuestran un interés sincero en mi como persona, no sólo como empleado</strong></th></tr>
                                                            <tr class="preg54" style="font-size:5px;"><th class="text-center" scope="col"><strong>Este es un lugar donde se disfruta trabajar</strong></th></tr>
                                                            <tr class="preg55" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes involucran a la gente en decisiones que afectan su trabajo o su ambiente laboral</strong></th></tr>
                                                            <tr class="preg56" style="font-size:5px;"><th class="text-center" scope="col"><strong>A las personas se les anima a que equilibren su vida laboral y su vida personal</strong></th></tr>
                                                            @*pegar 13 preguntas de respeto*@

                                                            <tr id="mergeQuestionsCoachings">
                                                                <td id="CategoriaCoaching" rowspan="8"><strong>COACHING</strong></td>
                                                            </tr>
                                                            <tr class="preg57" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes retroalimentan oportunamente el desempeño de sus colaboradores</strong></th></tr>
                                                            <tr class="preg58" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes generan acciones que apoyan a su equipo de trabajo para lograr los objetivos</strong></th></tr>
                                                            <tr class="preg59" style="font-size:5px;"><th class="text-center" scope="col"><strong>Cuando se requiere, los jefes proporcionan apoyo para dar solución a algún problema con un cliente</strong></th></tr>
                                                            <tr class="preg60" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes fomentan el aprendizaje ayudando a mejorar el desempeño de los colaboradores</strong></th></tr>
                                                            <tr class="preg61" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes me mantienen informado acerca de asuntos importantes del negocio</strong></th></tr>
                                                            <tr class="preg62" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes difunden y promueven los procesos del área para facilitar su aplicación</strong></th></tr>
                                                            <tr class="preg63" style="font-size:5px;"><th class="text-center" scope="col"><strong>Los jefes dan seguimiento a cumplimiento de objetivos</strong></th></tr>

                                                            @*pegar 13 preguntas de coaching*@

                                                            <tr id="mergeQuestionsCambioss">
                                                                <td id="CategoriaCambio" rowspan="4"><strong>CAMBIO</strong></td>
                                                            </tr>
                                                            <tr class="preg64" style="font-size:5px;"><th class="text-center" scope="col"><strong>Aquí nos adaptamos rápidamente a los cambios y nuevos métodos de trabajo</strong></th></tr>
                                                            <tr class="preg65" style="font-size:5px;"><th class="text-center" scope="col"><strong>Cuando hacemos cambios damos continuidad a lo que ya se hizo</strong></th></tr>
                                                            <tr class="preg66" style="font-size:5px;"><th class="text-center" scope="col"><strong>Las personas se sienten satisfechas sin importar las presiones que genera el cambio</strong></th></tr>
                                                            @*pegar 13 preguntas de coaching*@

                                                            <tr id="mergeQuestionsBienestars">
                                                                <td id="CategoriaBienestar" rowspan="13"><strong>BIENESTAR</strong></td>
                                                            </tr>
                                                            <tr class="preg67" style="font-size:5px;"><th class="text-center" scope="col"><strong>Encuentro tiempo para realizar alguna actividad física y mantenerme saludable</strong></th></tr>
                                                            <tr class="preg68" style="font-size:5px;"><th class="text-center" scope="col"><strong>Normalmente me ocupo de mantener hábitos alimenticios saludables</strong></th></tr>
                                                            <tr class="preg69" style="font-size:5px;"><th class="text-center" scope="col"><strong>Normalmente me siento con energía y motivado cuando me levanto por la mañana</strong></th></tr>
                                                            <tr class="preg70" style="font-size:5px;"><th class="text-center" scope="col"><strong>Normalmente me siento libre de fatiga cuando me levanto por la mañana</strong></th></tr>
                                                            <tr class="preg71" style="font-size:5px;"><th class="text-center" scope="col"><strong>Considero que lo que hago está alineado con lo que disfruto hacer</strong></th></tr>
                                                            <tr class="preg72" style="font-size:5px;"><th class="text-center" scope="col"><strong>Confío que mis capacidades, experiencia y acciones me garantizan crecimiento personal y profesional</strong></th></tr>
                                                            <tr class="preg73" style="font-size:5px;"><th class="text-center" scope="col"><strong>Siento que mi vida tiene sentido y propósito determinados</strong></th></tr>
                                                            <tr class="preg74" style="font-size:5px;"><th class="text-center" scope="col"><strong>Encuentro tiempo para meditar y alinear mis expectativas de vida</strong></th></tr>
                                                            <tr class="preg75" style="font-size:5px;"><th class="text-center" scope="col"><strong>Siempre produzco un efecto positivo y contribuyo a la alegría en los demás</strong></th></tr>
                                                            <tr class="preg76" style="font-size:5px;"><th class="text-center" scope="col"><strong>Considero que mis relaciones interpersonales benefician mi desarrollo como persona</strong></th></tr>
                                                            <tr class="preg77" style="font-size:5px;"><th class="text-center" scope="col"><strong>Normalmente me siento libre de estrés y ansiedad</strong></th></tr>
                                                            <tr class="preg78" style="font-size:5px;"><th class="text-center" scope="col"><strong>Encuentro tiempo de calidad para socializar y compartir con familiares o amigos</strong></th></tr>

                                                            @*pegar 13 preguntas de bienestar*@

                                                            <tr id="mergeQuestionsAlinCulturals">
                                                                <td id="CategoriaAlinCultural" rowspan="9"><strong>ALINEACION CULTURAL</strong></td>
                                                            </tr>
                                                            <tr class="preg79" style="font-size:5px;"><th class="text-center" scope="col"><strong>Aquí desarrollamos extraordinariamente nuestras labores, asegurando la preferencia de nuestros clientes internos y externos</strong></th></tr>
                                                            <tr class="preg80" style="font-size:5px;"><th class="text-center" scope="col"><strong>Promovemos un ambiente participativo y de respeto para juntos alcanzar y superar los resultados de la compañía</strong></th></tr>
                                                            <tr class="preg81" style="font-size:5px;"><th class="text-center" scope="col"><strong>Influimos e inspiramos a nuestros clientes y colegas para lograr las metas de la organización</strong></th></tr>
                                                            <tr class="preg82" style="font-size:5px;"><th class="text-center" scope="col"><strong>Aquí vivimos con entusiasmo los proyectos en los que participamos</strong></th></tr>
                                                            <tr class="preg83" style="font-size:5px;"><th class="text-center" scope="col"><strong>Aquí buscamos constantemente nuevas y mejores formas de hacer las cosas para ser más eficientes e incrementar la competitividad de la compañía</strong></th></tr>
                                                            <tr class="preg84" style="font-size:5px;"><th class="text-center" scope="col"><strong>Aquí la gente actúa basándose en la verdad, la transparencia y la congruencia</strong></th></tr>
                                                            <tr class="preg85" style="font-size:5px;"><th class="text-center" scope="col"><strong>Las personas muestran interés y buena disposición para apoyar a los demás</strong></th></tr>
                                                            <tr class="preg86" style="font-size:5px;"><th class="text-center" scope="col"><strong>Las personas proceden con apego a las normas y protocolos de nuestra organización</strong></th></tr>
                                                            @*pegar 13 preguntas de bienestar*@




                                                            <!--Promeios-->

                                                            <tr id="comodin">
                                                                <td id="" rowspan="1"><strong>COMODIN</strong></td>
                                                                <td id="preg87"><strong>La gente es tratada justamente sin importar su raza, sexo o preferencia sexual</strong></td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            <tr id="mergeParticipacion">
                                                                <td></td>
                                                                <td>PARTICIPACION</td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            <tr id="mergeCredibilidad">
                                                                <td></td>
                                                                <td style="background-color:#ED7D31;">CREDIBILIDAD</td>
                                                            </tr>

                                                            <tr id="mergeImparcialidad">
                                                                <td></td>
                                                                <td style="background-color:#FF5050;">IMPARCIALIDAD</td>
                                                            </tr>

                                                            <tr id="mergeOrgullo">
                                                                <td></td>
                                                                <td style="background-color:#FFC000">ORGULLO</td>
                                                            </tr>

                                                            <tr id="mergeRespeto">
                                                                <td></td>
                                                                <td style="background-color:#FFFF00">RESPETO</td>
                                                            </tr>

                                                            <tr id="mergeCompañerismo">
                                                                <td></td>
                                                                <td style="background-color:#8497B0">COMPAÑERISMO</td>
                                                            </tr>

                                                            <tr id="mergeCoaching">
                                                                <td></td>
                                                                <td style="background-color:#4472C4">COACHING</td>
                                                            </tr>

                                                            <tr id="mergeCambio">
                                                                <td></td>
                                                                <td style="background-color:#808080">CAMBIO</td>
                                                            </tr>

                                                            <tr id="mergeBienestar">
                                                                <td></td>
                                                                <td style="background-color:#00B0F0">BIENESTAR</td>
                                                            </tr>

                                                            <tr id="mergeAlignCultural">
                                                                <td></td>
                                                                <td style="background-color:#00B050">ALINEACION CULTURAL</td>
                                                            </tr>

                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            <tr id="mergeGestalt">
                                                                <td></td>
                                                                <td style="background-color:#7030A0">GESTALT</td>
                                                            </tr>

                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            <tr id="mergeConfianza">
                                                                <td></td>
                                                                <td>NIVEL DE CONFIANZA</td>
                                                            </tr>

                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            <tr id="mergeLogroDeResultados">
                                                                <td></td>
                                                                <td>TOTAL IMPULSORES CLAVES PARA EL LOGRO DE RESULTADOS</td>
                                                            </tr>

                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            <tr id="mergeProm66React">
                                                                <td></td>
                                                                <td style="background-color:#44546A;">PROMEDIO GENERAL 66 REACTIVOS</td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            <tr id="mergeProm86React">
                                                                <td></td>
                                                                <td style="background-color:#44546A">PROMEDIO GENERAL 86 REACTIVOS</td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            <tr id="mergePracticasCulturales">
                                                                <td colspan="2" style="background-color:#BFBFBF">PRÁCTICAS CULTURALES</td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                            </tr>


                                                            <!--Repeticion de preguntas-->
                                                            @* | *@
                                                            <tr id="mergeReclutandoBienvenida">
                                                                <td colspan="2" style="background-color:#BFBFBF">I. RECLUTANDO Y DANDO LA BIENVENIDA</td>
                                                            </tr>
                                                            <tr class="preg6" id="mergePorcentajePregunta6">
                                                                <td style="">6</td>
                                                                <td style="">Los jefes contratan gente de acuerdo a las necesidades de la empresa</td>
                                                            </tr>
                                                            <tr class="preg53" id="mergePorcentajePregunta53">
                                                                <td style="">53</td>
                                                                <td style="">Cuando ingresas a la compañía se te hace sentir bienvenido</td>
                                                            </tr>
                                                            @*||*@
                                                            <tr id="mergePromediosInspirando">
                                                                <td colspan="2" style="background-color:#BFBFBF">II. INSPIRANDO</td>
                                                            </tr>
                                                            <tr class="preg22" id="mergePromedioPreg22">
                                                                <td style="">22</td>
                                                                <td style="">Aquí se percibe un ambiente de excelencia, innovación, integridad, pasión y colaboración</td>
                                                            </tr>
                                                            <tr class="preg27" id="mergePromedioPreg27">
                                                                <td style="">27</td>
                                                                <td style="">En esta empresa existen buenas oportunidades de crecimiento</td>
                                                            </tr>
                                                            <tr class="preg10" id="mergePromedioPreg10">
                                                                <td style="">10</td>
                                                                <td style="">Los jefes tienen una visión clara de hacia dónde va la organización y de cómo lograrlo</td>
                                                            </tr>
                                                            <tr class="preg11" id="mergePromedioPreg11">
                                                                <td style="">11</td>
                                                                <td style="">Los jefes cumplen sus promesas</td>
                                                            </tr>
                                                            @*|||*@
                                                            <tr id="mergePromedioHablando">
                                                                <td colspan="2" style="background-color:#BFBFBF">III. HABLANDO</td>
                                                            </tr>
                                                            <tr class="preg1" id="mergePromedioPreg1">
                                                                <td style="">1</td>
                                                                <td style="">Los jefes me mantienen informado acerca de asuntos y cambios importantes</td>
                                                            </tr>
                                                            <tr class="preg2" id="mergePromedioPreg2">
                                                                <td style="">2</td>
                                                                <td style="">Los jefes comunican claramente sus expectativas</td>
                                                            </tr>
                                                            <tr class="preg12" id="mergePromedioPreg12">
                                                                <td style="">12</td>
                                                                <td style="">Las palabras de los jefes coinciden con sus acciones</td>
                                                            </tr>
                                                            @*IV*@
                                                            <tr id="mergePromedioEscuchando">
                                                                <td colspan="2" style="background-color:#BFBFBF">IV. ESCUCHANDO</td>
                                                            </tr>
                                                            <tr class="preg3" id="mergePromedio3">
                                                                <td style="">3</td>
                                                                <td style="">Puedo hacer a los jefes cualquier pregunta razonable y recibir una respuesta clara</td>
                                                            </tr>
                                                            <tr class="preg4" id="mergePromedio4">
                                                                <td style="">4</td>
                                                                <td style="">Los jefes son accesibles y es fácil hablar con ellos</td>
                                                            </tr>
                                                            <tr class="preg39" id="mergePromedio39">
                                                                <td style="">39</td>
                                                                <td style="">Si soy tratado injustamente, sé que tendré oportunidad de ser escuchado y recibir un trato justo</td>
                                                            </tr>
                                                            <tr class="preg19" id="mergePromedio19">
                                                                <td style="">19</td>
                                                                <td style="">Los jefes fomentan y responden genuinamente a nuestras sugerencias e ideas</td>
                                                            </tr>
                                                            @*V*@
                                                            <tr id="mergePromedioAgradeciendo">
                                                                <td colspan="2" style="background-color:#BFBFBF">V. AGRADECIENDO</td>
                                                            </tr>
                                                            <tr class="preg17" id="mergePromedioPregunta17">
                                                                <td style="">17</td>
                                                                <td style="">Los jefes reconocen el trabajo bien hecho y el esfuerzo extra</td>
                                                            </tr>
                                                            <tr class="preg30" id="mergePromedioPregunta30">
                                                                <td style="">30</td>
                                                                <td style="">Todos tenemos la oportunidad de ser reconocidos por nuestro trabajo</td>
                                                            </tr>
                                                            @*VI*@
                                                            <tr id="mergePromedioDesarrollando">
                                                                <td colspan="2" style="background-color:#BFBFBF">VI. DESARROLLANDO</td>
                                                            </tr>
                                                            <tr class="preg49" id="mergePromedioPregunta49">
                                                                <td style="">49</td>
                                                                <td style="">Se evalúa el desempeño de la gente de manera justa</td>
                                                            </tr>
                                                            <tr class="preg15" id="mergePromedioPregunta15">
                                                                <td style="">15</td>
                                                                <td style="">Me ofrecen capacitación u otro tipo de desarrollo para apoyar mi crecimiento profesional</td>
                                                            </tr>
                                                            <tr class="preg16" id="mergePromedioPregunta16">
                                                                <td style="">16</td>
                                                                <td style="">Me dan los recursos y herramientas necesarias para hacer mi trabajo</td>
                                                            </tr>
                                                            <tr class="preg32" id="mergePromedioPregunta32">
                                                                <td style="">32</td>
                                                                <td style="">Los ascensos se dan a quienes más los merecen</td>
                                                            </tr>
                                                            @*VII*@
                                                            <tr id="mergePromedioCuidando">
                                                                <td colspan="2" style="background-color:#BFBFBF">VII. CUIDANDO</td>
                                                            </tr>
                                                            <tr class="preg25" id="mergePromedioPregunta25">
                                                                <td style="">25</td>
                                                                <td style="">A las personas se les anima a que equilibren su vida laboral y su vida personal</td>
                                                            </tr>
                                                            <tr class="preg26" id="mergePromedioPregunta26">
                                                                <td style="">26</td>
                                                                <td style="">Los jefes demuestran un interés sincero en mi como persona, no sólo como empleado</td>
                                                            </tr>
                                                            <tr class="preg33" id="mergePromedioPregunta33">
                                                                <td style="">33</td>
                                                                <td style="">Los jefes evitan tener empleados favoritos</td>
                                                            </tr>
                                                            <tr class="preg50" id="mergePromedioPregunta50">
                                                                <td style="">50</td>
                                                                <td style="">Aquí las personas se preocupan por los demás</td>
                                                            </tr>
                                                            @*VIII*@
                                                            <tr id="mergePromedioPercepcionLugar">
                                                                <td colspan="2" style="background-color:#BFBFBF">VIII. PERCEPCION DEL LUGAR</td>
                                                            </tr>
                                                            <tr class="preg51" id="mergePromedioPreg51">
                                                                <td style="">51</td>
                                                                <td style="">Este es un lugar amigable para trabajar</td>
                                                            </tr>
                                                            <tr class="preg52" id="mergePromedioPreg52">
                                                                <td style="">52</td>
                                                                <td style="">Este es un lugar donde se disfruta trabajar</td>
                                                            </tr>
                                                            @*IX*@
                                                            <tr id="mergePromedioCooperando">
                                                                <td colspan="2" style="background-color:#BFBFBF">IX. COOPERANDO</td>
                                                            </tr>
                                                            <tr class="preg19" id="mergePromedioPreg19">
                                                                <td style="">19</td>
                                                                <td style="">Los jefes fomentan y responden genuinamente a nuestras sugerencias e ideas</td>
                                                            </tr>
                                                            <tr class="preg20" id="mergePromedioPreg20">
                                                                <td style="">20</td>
                                                                <td style="">Los jefes involucran a la gente en decisiones que afectan su trabajo o su ambiente laboral</td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            @*ALINEACION ESTRATEGICA*@
                                                            <tr id="mergePromedioAlinEstrategica">
                                                                <td colspan="2" style="background-color:#00B0F0">ALINEACION ESTRATEGICA</td>
                                                            </tr>
                                                            <tr class="preg10" id="mergePromedioPreg10">
                                                                <td style="">10</td>
                                                                <td style="">Los jefes tienen una visión clara de hacia dónde va la organización y de cómo lograrlo</td>
                                                            </tr>
                                                            <tr class="preg22" id="mergePromedioPreg22">
                                                                <td style="">22</td>
                                                                <td style="">Aquí se percibe un ambiente de excelencia, innovación, integridad, pasión y colaboración</td>
                                                            </tr>
                                                            <tr class="preg47" id="mergePromedioPreg47">
                                                                <td style="">47</td>
                                                                <td style="">La gente conoce los objetivos y metas de su trabajo</td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            <tr id="mergePromedioProcesosOrgan">
                                                                <td colspan="2" style="background-color:#7030A0">INDICADORES DE PROCESOS ORGANIZACIONALES</td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            @*I*@
                                                            <tr id="mergeBalanceVida">
                                                                <td colspan="2" style="background-color:#7030A0">BALANCE DE VIDA</td>
                                                            </tr>
                                                            <tr class="preg25" id="mergePromedioPreg25">
                                                                <td style="">25</td>
                                                                <td style="">A las personas se les anima a que equilibren su vida laboral y su vida personal</td>
                                                            </tr>
                                                            @*II*@
                                                            <tr id="mergeReclutamiento">
                                                                <td colspan="2" style="background-color:#7030A0">II. PROCESO DE RECLUTAMIENTO Y SELECCIÓN DE PERSONAL</td>
                                                            </tr>
                                                            <tr class="preg6" id="mergePromedioPregReclutamiento6">
                                                                <td style="">6</td>
                                                                <td style="">Los jefes contratan gente de acuerdo a las necesidades de la empresa</td>
                                                            </tr>
                                                            @*III*@
                                                            <tr id="mergePlanesCarrera">
                                                                <td colspan="2" style="background-color:#7030A0">III. PLANES DE CARRERA Y PROMOCIÓN DE PERSONAL</td>
                                                            </tr>
                                                            <tr class="preg27" id="mergePromPregunta27">
                                                                <td style="">27</td>
                                                                <td style="">En esta empresa existen buenas oportunidades de crecimiento</td>
                                                            </tr>
                                                            <tr class="preg32" id="mergePromPregunta32">
                                                                <td style="">32</td>
                                                                <td style="">Los ascensos se dan a quienes más los merecen</td>
                                                            </tr>
                                                            @*IV*@
                                                            <tr id="mergePromCapacitacionDesarrollo">
                                                                <td colspan="2" style="background-color:#7030A0">IV. PLANES DE CAPACITACIÓN Y DESARROLLO</td>
                                                            </tr>
                                                            <tr class="preg63" id="mergePorcentaje63">
                                                                <td style="">63</td>
                                                                <td style="">Los jefes fomentan el aprendizaje ayudando a mejorar el desempeño de los colaboradores</td>
                                                            </tr>
                                                            <tr class="preg15" id="mergePorcentaje15">
                                                                <td style="">15</td>
                                                                <td style="">Me ofrecen capacitación u otro tipo de desarrollo para apoyar mi crecimiento profesional</td>
                                                            </tr>
                                                            @*V*@
                                                            <tr id="mergePromedioEMPOWERMENT">
                                                                <td colspan="2" style="background-color:#7030A0">V. EMPOWERMENT</td>
                                                            </tr>
                                                            <tr class="preg8" id="mergePromedioPre8">
                                                                <td style="">8</td>
                                                                <td style="">Los jefes confían que los colaboradores hacen un buen trabajo sin supervisarlos continuamente</td>
                                                            </tr>
                                                            <tr class="preg9" id="mergePromedioPre9">
                                                                <td style="">9</td>
                                                                <td style="">Aquí a la gente se le delegan responsabilidades</td>
                                                            </tr>
                                                            @*VI*@
                                                            <tr id="mergeEvalDesempeño">
                                                                <td colspan="2" style="background-color:#7030A0">VI. EVALUACIÓN DEL DESEMPEÑO</td>
                                                            </tr>
                                                            <tr class="preg47" id="mergePromedioPregu47">
                                                                <td style="">47</td>
                                                                <td style="">La gente conoce los objetivos y metas de su trabajo</td>
                                                            </tr>
                                                            <tr class="preg49" id="mergePromedioPregu49">
                                                                <td style="">49</td>
                                                                <td style="">Se evalúa el desempeño de la gente de manera justa</td>
                                                            </tr>
                                                            @*VII*@
                                                            <tr id="mergePoliticaCompensacion">
                                                                <td colspan="2" style="background-color:#7030A0">VII. POLÍTICA DE COMPENSACIÓN</td>
                                                            </tr>
                                                            <tr class="preg28" id="mergePreguntaa28">
                                                                <td style="">28</td>
                                                                <td style="">A las personas se les paga de acuerdo al trabajo que realizan</td>
                                                            </tr>
                                                            @*VIII*@
                                                            <tr id="mergePromedioReconocimientoInst">
                                                                <td colspan="2" style="background-color:#7030A0">VIII. SISTEMA DE RECONOCIMIENTOS INSTITUCIONALES</td>
                                                            </tr>
                                                            <tr class="preg30" id="mergePreguntaa30">
                                                                <td style="">30</td>
                                                                <td style="">Todos tenemos la oportunidad de ser reconocidos por nuestro trabajo</td>
                                                            </tr>
                                                            @*IX*@
                                                            <tr id="mergePromedioIntegracion">
                                                                <td colspan="2" style="background-color:#7030A0">IX. INTEGRACION</td>
                                                            </tr>
                                                            <tr class="preg50" id="mergePreg50">
                                                                <td style="">50</td>
                                                                <td style="">Aquí las personas se preocupan por los demás</td>
                                                            </tr>
                                                            <tr class="preg55" id="mergePreg55">
                                                                <td style="">55</td>
                                                                <td style="">Aquí las personas tienen un sentido de equipo</td>
                                                            </tr>
                                                            <tr class="preg56" id="mergePreg56">
                                                                <td style="">56</td>
                                                                <td style="">Estamos todos juntos en esto</td>
                                                            </tr>
                                                            @*X*@
                                                            <tr id="mergeCanalesInst">
                                                                <td colspan="2" style="background-color:#7030A0">X. CANALES INSTITUCIONALES DE APELACIÓN</td>
                                                            </tr>
                                                            <tr class="preg39" id="mergePreguntaa39">
                                                                <td style="">39</td>
                                                                <td style="">Si soy tratado injustamente, sé que tendré oportunidad de ser escuchado y recibir un trato justo</td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            @*NIVEL DE COLABORACION*@
                                                            <tr id="mergeNivelCoolaboracion">
                                                                <td colspan="2" style="background-color:#2F75B5">NIVEL DE COLABORACION</td>
                                                            </tr>
                                                            <tr class="preg43" id="mergePromedioR43">
                                                                <td style="">43</td>
                                                                <td style="">Las personas están dispuestas a hacer un esfuerzo extra para realizar el trabajo</td>
                                                            </tr>
                                                            <tr class="preg57" id="mergePromedioR57">
                                                                <td style="">57</td>
                                                                <td style="">Puedo contar con la ayuda de las personas</td>
                                                            </tr>
                                                            <tr class="preg55" id="mergePromedioR55">
                                                                <td style="">55</td>
                                                                <td style="">Aquí las personas tienen un sentido de equipo</td>
                                                            </tr>
                                                            <tr class="preg19" id="mergePromedioR19">
                                                                <td style="">19</td>
                                                                <td style="">Los jefes fomentan y responden genuinamente a nuestras sugerencias e ideas</td>
                                                            </tr>
                                                            <tr class="preg20" id="mergePromedioR20">
                                                                <td style="">20</td>
                                                                <td style="">Los jefes involucran a la gente en decisiones que afectan su trabajo o su ambiente laboral</td>
                                                            </tr>
                                                            <tr class="preg59" id="mergePromedioR59">
                                                                <td style="">59</td>
                                                                <td style="">Los jefes promueven el trabajo en equipo</td>
                                                            </tr>

                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            @*NIVEL DE COMPRMISO*@
                                                            <tr id="mergePromedioNivelCompromiso">
                                                                <td colspan="2" style="background-color:#D60093">NIVEL DE COMPRIMISO</td>
                                                            </tr>
                                                            <tr class="preg41" id="mergePromedioRR41">
                                                                <td style="">41</td>
                                                                <td style="">Mi trabajo tiene un significado especial; para mí éste no es “sólo un trabajo”</td>
                                                            </tr>
                                                            <tr class="preg43" id="mergePromedioRR43">
                                                                <td style="">43</td>
                                                                <td style="">Las personas están dispuestas a hacer un esfuerzo extra para realizar el trabajo</td>
                                                            </tr>
                                                            <tr class="preg44" id="mergePromedioRR44">
                                                                <td style="">44</td>
                                                                <td style="">Deseo trabajar aquí por un largo tiempo</td>
                                                            </tr>
                                                            <tr class="preg45" id="mergePromedioRR45">
                                                                <td style="">45</td>
                                                                <td style="">Estoy orgulloso de decirle a otros que trabajo aquí</td>
                                                            </tr>
                                                            <tr class="preg56" id="mergePromedioRR56">
                                                                <td style="">56</td>
                                                                <td style="">Estamos todos juntos en esto</td>
                                                            </tr>

                                                            <tr>
                                                                <td></td>
                                                            </tr>
                                                            <tr id="mergeIso">
                                                                <td colspan="2" style="background-color:#44546A">ISO 9001:2015 AMBIENTE PARA LA OPERACIÓN DE LOS PROCESOS</td>
                                                            </tr>
                                                            <tr id="mergeProm86React">
                                                                <td colspan="2" style="">
                                                                    La Organización debe determinar, proporcionar y mantener el ambiente necesario para la operación de sus procesos y para lograr la conformidad de los productos y servicios.
                                                                    NOTA: Un ambiente adecuado puede ser una combinación de factores humanos y físicos, tales como:
                                                                    a) sociales (por ejemplo, no discriminatorio, ambiente tranquilo, libre de conflictos);
                                                                    b) psicológicos (por ejemplo, reducción del estrés, prevención del síndrome de agotamiento, cuidado de las emociones);
                                                                    c) físicos (por ejemplo, temperatura, calor, humedad, iluminación, circulación del aire, higiene, ruido).
                                                                    Estos factores pueden diferir sustancialmente dependiendo de los productos y servicios suministrados.
                                                                </td>
                                                            </tr>
                                                            @* I *@
                                                            <tr id="mergePromedioFactorSocial">
                                                                <td colspan="2" style="background-color:#44546A">I. FACTOR SOCIAL Promedio (31, 32, 34, 35, 36 y 38)</td>
                                                            </tr>
                                                            <tr class="preg31" id="porcentaje31">
                                                                <td style="">31</td>
                                                                <td style="">Me tratan bien independientemente de mi posición en la empresa</td>
                                                            </tr>
                                                            <tr class="preg48" id="porcentaje48">
                                                                <td style="">48</td>
                                                                <td style="">Aquí se respeta la forma de ser de las personas</td>
                                                            </tr>
                                                            <tr class="preg37" id="porcentaje37">
                                                                <td style="">37</td>
                                                                <td style="">La gente es tratada justamente sin importar su sexo</td>
                                                            </tr>
                                                            <tr class="preg35" id="porcentaje35">
                                                                <td style="">35</td>
                                                                <td style="">La gente es tratada justamente sin importar su edad</td>
                                                            </tr>
                                                            <tr class="preg36" id="porcentaje36">
                                                                <td style="">36</td>
                                                                <td style="">La gente es tratada justamente sin importar su raza</td>
                                                            </tr>
                                                            <tr class="preg38" id="porcentaje38">
                                                                <td style="">38</td>
                                                                <td style="">La gente es tratada justamente sin importar su preferencia sexual</td>
                                                            </tr>

                                                            @* II *@
                                                            <tr id="mergePromedioPsico">
                                                                <td colspan="2" style="background-color:#44546A">II. FACTOR PSICOLÓGICO Promedio (22, 46, 48, 51 y 52)</td>
                                                            </tr>
                                                            <tr class="preg34" id="mergeporc34">
                                                                <td style="">34</td>
                                                                <td style="">Aquí evitamos hablar mal de las personas para obtener un beneficio personal</td>
                                                            </tr>
                                                            <tr class="preg39" id="mergeporc39">
                                                                <td style="">39</td>
                                                                <td style="">Si soy tratado injustamente, sé que tendré oportunidad de ser escuchado y recibir un trato justo</td>
                                                            </tr>
                                                            <tr class="preg46" id="mergeporc46">
                                                                <td style="">46</td>
                                                                <td style="">A la gente le gusta venir a trabajar aquí</td>
                                                            </tr>
                                                            <tr class="preg51" id="mergeporc51">
                                                                <td style="">51</td>
                                                                <td style="">Este es un lugar amigable para trabajar</td>
                                                            </tr>
                                                            <tr class="preg52" id="mergeporc52">
                                                                <td style="">52</td>
                                                                <td style="">Este es un lugar donde se disfruta trabajar</td>
                                                            </tr>

                                                            @* III *@
                                                            <tr id="mergePromFactorFisico">
                                                                <td colspan="2" style="background-color:#44546A">II. FACTOR FÍSICO Promedio (16, 21 y 23)</td>
                                                            </tr>
                                                            <tr class="preg16" id="mergerr16">
                                                                <td style="">16</td>
                                                                <td style="">Me dan los recursos y herramientas necesarias para hacer mi trabajo</td>
                                                            </tr>
                                                            <tr class="preg21" id="mergerr21">
                                                                <td style="">21</td>
                                                                <td style="">Este es un lugar físicamente seguro en donde trabajar</td>
                                                            </tr>
                                                            <tr class="preg23" id="mergerr23">
                                                                <td style="">23</td>
                                                                <td style="">Las instalaciones contribuyen a un buen ambiente de trabajo</td>
                                                            </tr>

                                                            <tr>
                                                                <td></td>
                                                            </tr>

                                                            @* ALINEACION CULTURAL *@
                                                            <tr id="mergealincultral">
                                                                <td colspan="2" style="background-color:#00B050">ALINEACION CULTURAL</td>
                                                            </tr>
                                                            <tr class="preg68" id="merger68">
                                                                <td style="">68</td>
                                                                <td style="">Aquí desarrollamos extraordinariamente nuestras labores, asegurando la preferencia de nuestros clientes internos y externos</td>
                                                            </tr>
                                                            <tr class="preg70" id="merger70">
                                                                <td style="">70</td>
                                                                <td style="">Promovemos un ambiente participativo y de respeto para juntos alcanzar y superar los resultados de la compañía</td>
                                                            </tr>
                                                            <tr class="preg72" id="merger72">
                                                                <td style="">72</td>
                                                                <td style="">Influimos e inspiramos a nuestros clientes y colegas para lograr las metas de la organización</td>
                                                            </tr>
                                                            <tr class="preg74" id="merger74">
                                                                <td style="">74</td>
                                                                <td style="">Aquí vivimos con entusiasmo los proyectos en los que participamos</td>
                                                            </tr>
                                                            <tr class="preg76" id="merger76">
                                                                <td style="">76</td>
                                                                <td style="">Aquí buscamos constantemente nuevas y mejores formas de hacer las cosas para ser más eficientes e incrementar la competitividad de la compañía</td>
                                                            </tr>
                                                            <tr class="preg78" id="merger78">
                                                                <td style="">78</td>
                                                                <td style="">Aquí la gente actúa basándose en la verdad, la transparencia y la congruencia</td>
                                                            </tr>
                                                            <tr class="preg82" id="merger82">
                                                                <td style="">82</td>
                                                                <td style="">Las personas muestran interés y buena disposición para apoyar a los demás</td>
                                                            </tr>
                                                            <tr class="preg85" id="merger85">
                                                                <td style="">85</td>
                                                                <td style="">Las personas proceden con apego a las normas y protocolos de nuestra organización</td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                            </tr>

                                                            @* BIENESTAR *@
                                                            <tr id="mergebienestarss">
                                                                <td colspan="2" style="background-color:#00B0F0">BIENESTAR</td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                            </tr>

                                                            @* I *@
                                                            <tr id="mergePromedioBio">
                                                                <td colspan="2" style="background-color:#00B0F0">I. FACTOR BIOLÓGICO</td>
                                                            </tr>
                                                            <tr class="preg67" id="mergerpre67">
                                                                <td style="">67</td>
                                                                <td style="">Encuentro tiempo para realizar alguna actividad física y mantenerme saludable</td>
                                                            </tr>
                                                            <tr class="preg71" id="mergerpre71">
                                                                <td style="">71</td>
                                                                <td style="">Normalmente me ocupo de mantener hábitos alimenticios saludables</td>
                                                            </tr>
                                                            <tr class="preg75" id="mergerpre75">
                                                                <td style="">75</td>
                                                                <td style="">Normalmente me siento con energía y motivado cuando me levanto por la mañana</td>
                                                            </tr>
                                                            <tr class="preg84" id="mergerpre84">
                                                                <td style="">84</td>
                                                                <td style="">Normalmente me siento libre de fatiga cuando me levanto por la mañana</td>
                                                            </tr>

                                                            @* II *@
                                                            <tr id="mergerPsicos">
                                                                <td colspan="2" style="background-color:#00B0F0">I. FACTOR PSICOLÓGICO</td>
                                                            </tr>
                                                            <tr class="preg79" id="mergers79">
                                                                <td style="">79</td>
                                                                <td style="">Considero que lo que hago está alineado con lo que disfruto hacer</td>
                                                            </tr>
                                                            <tr class="preg81" id="mergers81">
                                                                <td style="">81</td>
                                                                <td style="">Confío que mis capacidades, experiencia y acciones me garantizan crecimiento personal y profesional</td>
                                                            </tr>
                                                            <tr class="preg83" id="mergers83">
                                                                <td style="">83</td>
                                                                <td style="">Siento que mi vida tiene sentido y propósito determinados</td>
                                                            </tr>
                                                            <tr class="preg86" id="mergers86">
                                                                <td style="">86</td>
                                                                <td style="">Encuentro tiempo para meditar y alinear mis expectativas de vida</td>
                                                            </tr>

                                                            @* III *@
                                                            <tr id="mergePromSocial">
                                                                <td colspan="2" style="background-color:#00B0F0">I. FACTOR SOCIAL</td>
                                                            </tr>
                                                            <tr class="preg69" id="mergers69">
                                                                <td style="">69</td>
                                                                <td style="">Siempre produzco un efecto positivo y contribuyo a la alegría en los demás</td>
                                                            </tr>
                                                            <tr class="preg73" id="mergers73">
                                                                <td style="">73</td>
                                                                <td style="">Considero que mis relaciones interpersonales benefician mi desarrollo como persona</td>
                                                            </tr>
                                                            <tr class="preg77" id="mergers77">
                                                                <td style="">77</td>
                                                                <td style="">Normalmente me siento libre de estrés y ansiedad</td>
                                                            </tr>
                                                            <tr class="preg80" id="mergers80">
                                                                <td style="">80</td>
                                                                <td style="">Encuentro tiempo de calidad para socializar y compartir con familiares o amigos</td>
                                                            </tr>

                                                            <tr>
                                                                <td></td>
                                                            </tr>

                                                            @* III *@
                                                            <tr id="mergePromNaranja">
                                                                <td colspan="2" style="background-color:#ED7D31">NIVEL DE HABILIDADES GERENCIALES</td>
                                                            </tr>
                                                            <tr>
                                                                <td></td>
                                                            </tr>

                                                            @* I *@
                                                            <tr id="mergePromedioComunicacion">
                                                                <td colspan="2" style="background-color:#ED7D31">I. COMUNICACION</td>
                                                            </tr>
                                                            <tr class="preg1" id="mergerpre1">
                                                                <td style="">1</td>
                                                                <td style="">Los jefes me mantienen informado acerca de asuntos y cambios importantes</td>
                                                            </tr>
                                                            <tr class="preg2" id="mergerpre2">
                                                                <td style="">2</td>
                                                                <td style="">Los jefes comunican claramente sus expectativas</td>
                                                            </tr>
                                                            <tr class="preg3" id="mergerpre3">
                                                                <td style="">3</td>
                                                                <td style="">Puedo hacer a los jefes cualquier pregunta razonable y recibir una respuesta clara</td>
                                                            </tr>
                                                            <tr class="preg64" id="mergerpre64">
                                                                <td style="">64</td>
                                                                <td style="">Los jefes me mantienen informado acerca de asuntos importantes del negocio</td>
                                                            </tr>
                                                            <tr class="preg4" id="mergerpre4">
                                                                <td style="">4</td>
                                                                <td style="">Los jefes son accesibles y es fácil hablar con ellos</td>
                                                            </tr>

                                                            @* II *@
                                                            <tr id="mergePromedioEnpow">
                                                                <td colspan="2" style="background-color:#ED7D31">II. EMPOWERMENT</td>
                                                            </tr>
                                                            <tr class="preg8" id="mergers8">
                                                                <td style="">8</td>
                                                                <td style="">Los jefes confían que los colaboradores hacen un buen trabajo sin supervisarlos continuamente</td>
                                                            </tr>
                                                            <tr class="preg9" id="mergers9">
                                                                <td style="">9</td>
                                                                <td style="">Aquí a la gente se le delegan responsabilidades</td>
                                                            </tr>
                                                            <tr class="preg18" id="mergers18">
                                                                <td style="">18</td>
                                                                <td style="">Los jefes reconocen que pueden cometerse errores involuntarios al hacer el trabajo</td>
                                                            </tr>

                                                            @* III *@
                                                            <tr id="mergecoordinaciontrabajo">
                                                                <td colspan="2" style="background-color:#ED7D31">III. COORDINACIÓN DEL EQUIPO DE TRABAJO</td>
                                                            </tr>
                                                            <tr class="preg61" id="mergeProme61">
                                                                <td style="">61</td>
                                                                <td style="">Los jefes generan acciones que apoyan a su equipo de trabajo para lograr los objetivos</td>
                                                            </tr>
                                                            <tr class="preg62" id="mergeProme62">
                                                                <td style="">62</td>
                                                                <td style="">Cuando se requiere, los jefes proporcionan apoyo para dar solución a algún problema con un cliente</td>
                                                            </tr>
                                                            <tr class="preg65" id="mergeProme65">
                                                                <td style="">65</td>
                                                                <td style="">Los jefes difunden y promueven los procesos del área para facilitar su aplicación</td>
                                                            </tr>
                                                            <tr class="preg59" id="mergeProme59">
                                                                <td style="">59</td>
                                                                <td style="">Los jefes promueven el trabajo en equipo</td>
                                                            </tr>
                                                            <tr class="preg7" id="mergeProme7">
                                                                <td style="">7</td>
                                                                <td style="">Los jefes asignan y coordinan bien al personal</td>
                                                            </tr>

                                                            @* IV *@
                                                            <tr id="mergePromVisionEstr">
                                                                <td colspan="2" style="background-color:#ED7D31">IV. VISIÓN ESTRATÉGICA</td>
                                                            </tr>
                                                            <tr class="preg6" id="mergePromedios6">
                                                                <td style="">6</td>
                                                                <td style="">Los jefes contratan gente de acuerdo a las necesidades de la empresa</td>
                                                            </tr>
                                                            <tr class="preg10" id="mergePromedios10">
                                                                <td style="">10</td>
                                                                <td style="">Los jefes tienen una visión clara de hacia dónde va la organización y de cómo lograrlo</td>
                                                            </tr>

                                                            @* V *@
                                                            <tr id="mergePromedioNivelDese">
                                                                <td colspan="2" style="background-color:#ED7D31">V. EVALUACIÓN DEL DESEMPEÑO Y RETROALIMENTACIÓN</td>
                                                            </tr>
                                                            <tr class="preg47" id="mergerd47">
                                                                <td style="">47</td>
                                                                <td style="">La gente conoce los objetivos y metas de su trabajo</td>
                                                            </tr>
                                                            <tr class="preg66" id="mergerd66">
                                                                <td style="">66</td>
                                                                <td style="">Los jefes dan seguimiento a cumplimiento de objetivos</td>
                                                            </tr>
                                                            <tr class="preg60" id="mergerd60">
                                                                <td style="">60</td>
                                                                <td style="">Los jefes retroalimentan oportunamente el desempeño de sus colaboradores</td>
                                                            </tr>
                                                            <tr class="preg17" id="mergerd17">
                                                                <td style="">17</td>
                                                                <td style="">Los jefes reconocen el trabajo bien hecho y el esfuerzo extra</td>
                                                            </tr>
                                                            <tr class="preg49" id="mergerd49">
                                                                <td style="">49</td>
                                                                <td style="">Se evalúa el desempeño de la gente de manera justa</td>
                                                            </tr>

                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div><!--.tab-pane-->
                        </div>
                    </div>
                    <div class="tab-pane fade" id="manag" role="tabpanel" aria-labelledby="manag-tab">
                        <div class="section-survey shadow-sm animated fadeInUp">
                            <div class="body-survey">
                                <div class="row">
                                    <div class="col-md-12 col-lg-12 col-sm-12 col-xs-12" id="mydv">
                                        <h3 id="message">Reportes cargandose</h3>
                                        <table id="tableAux" class="table table-hover table-responsive">
                                            <thead>
                                                <tr>
                                                    <th class="text-center" scope="col">IdReporte</th>
                                                    <th class="text-center" scope="col">Nombre</th>
                                                    <th class="text-center" scope="col">Unidad de Negocio</th>
                                                    <th class="text-center" scope="col">Enfoque</th>
                                                    <th class="text-center col-md-2" scope="col">Avance</th>
                                                    @*<th class="text-center" scope="col">Reintentar</th>*@
                                                    <th class="text-center" scope="col">Generar reporte</th>
                                                </tr>
                                            </thead>
                                            <tbody id="bodygetReport"></tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><!--.tab-pane-->
                </div><!--.tab-content-->
                <div class="form-group">
                    <input id="EE" type="submit" name="name" value="Generar Enfoque Empresa" class="btn btn-success" onclick="readHeadersValue('EE')" />
                </div>
                <div class="form-group">
                    <input id="EA" type="submit" name="name" value="Generar Enfoque Área" class="btn btn-success" onclick="readHeadersValue('EA')" />
                </div>
            </div>
            <div id="mergeTableExport">

            </div>
               
            </div>
        </div>
</section>
@section Scripts{
<script src="~/scripts/jquery-3.4.1.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>
    function validaBoton() {
        var unegocioSelect = $('#UnidadNegocio option:selected').text();
        unegocioSelect = 'UNeg=>' + unegocioSelect;
        var table = document.getElementById('tableAux');
        
        for (var i = 1; i < table.rows.length; i++) {
            var val1 = table.rows[i].cells[2].innerText;//Uneg
            var val2 = table.rows[i].cells[3].innerText;//Enfoque
            if (val1 == unegocioSelect && val2 == 'Enfoque Empresa') {
                $('#EE').attr("onclick", "swal('Ya no es posible solicitar este reporte porque ya se esta cargando', '', 'info')");
            }
            if (val1 == unegocioSelect && val2 == 'Enfoque Area') {
                $('#EA').attr("onclick", "swal('Ya no es posible solicitar este reporte porque ya se esta cargando', '', 'info')");
            }
        }
    }
</script>
<script>
    function getTableBase64() {
        var tablePureHtml = '<table id="tableReport" class="table table-responsive table-bordered">';
        tablePureHtml += $('#myTable').html();
        tablePureHtml += '</table>';
        tablePureHtml = tablePureHtml.replace(/  /g, '')
        tablePureHtml = tablePureHtml.replace(/(\r\n|\n|\r)/gm, "");
        return tablePureHtml;
    }
</script>

    <script>
        $(document).ready(function () {
            $('#UnidadNegocio').append('<option value="0">Selecciona</option>');
            $.ajax({
                url: 'GetAllUneg',
                type: 'GET',
                complete: function (val) {
                    if(val.responseJSON.length > 0){
                        for (var i = 0; i < val.responseJSON.length; i++) {
                            $('#UnidadNegocio').append('<option value="' + val.responseJSON[i].IdCompanyCategoria + '">' + val.responseJSON[i].Descripcion + '</option>');
                        }
                    }
                }
            });
            $('#CategoriaCredibilidad').css('background-color', '#ed7c31');
            $('#CategoriaImparcialidad').css('background-color', '#FF5050');
            $('#CategoriaOrgullo').css('background-color', '#ffbf00');
            $('#CategoriaGestalt').css('background-color', '#6f30a0');
            $('#CategoriaCompañerismo').css('background-color', '#8497b0');
            $('#CategoriaRespeto').css('background-color', '#ffff00');
            $('#CategoriaCoaching').css('background-color', '#4473c4');
            $('#CategoriaCambio').css('background-color', '#808080');
            $('#CategoriaBienestar').css('background-color', '#00b0f0');
            $('#CategoriaAlinCultural').css('background-color', '#00b04f');
            $('th').addClass('text-center');
            if ($('#UnidadNegocio').val() == 0) {
                return false;
            }
            let companydta = { CompanyName: $('#UnidadNegocio').val() }
        });
    </script>
<script>
    function readHeadersValue(parameterEnfoque) {

        swal('El reporte ha empezado a generarse. Para visualizar el porcentaje de avance vaya a la pestaña Estatus del Reporte', '', 'info');

        var columnas = document.getElementById('myTable').rows[1].cells.length;
        var filtros = [];
        for (var i = 0; i < columnas; i++) {
            var cellValue = document.getElementById('myTable').rows[1].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtros.push(cellValue);
        }
        console.log(filtros);
        
        var unidadNegocioFinal = $('#cellUNeg').text();
        var finalUnegocio = unidadNegocioFinal.replace('UNeg=>', '');
        //alert(finalUnegocio);

        var tableHTML = getTableBase64();
        var noCols = document.getElementById('myTable').rows[1].cells.length;

        let model = {
            filtro: '',
            usuarioCreacion: 'asd',
            UnidadNegocioFilter: finalUnegocio,
            listFiltros: filtros,
            tableHTML: tableHTML,
            enfoque: parameterEnfoque,
            noColumnas: noCols
        };
        var data = JSON.stringify(model);
        //swal({
        //    title: "El administrador se registró correctamente, las claves de acceso serán enviadas al correo electrónico del nuevo administrador",
        //    text: "",
        //    type: "success",
        //    icon: "success",
        //}).then(function () {
        //    window.location.href = "/Administrador/GetAll/";
        //});
        
        
        $.ajax({
            url: '@Url.Action("JobReporte", "ReportClimaLaboral")',
            contentType: 'application/json; charset=utf-8',
            type: 'POST',
            data: data, traditional: true,
            complete: function () {
                window.location.href = '/DashBoard/DashBoard/';
            }
        });
    }
</script>
<script>
    $('#UnidadNegocio').change(function () {
        validaBoton();
        if ($('#UnidadNegocio').val() == 0) {
            $('#cellUNeg').text('UNeg=>');
            $('#myTable').hide();
            $('#EA').hide();
            $('#EE').hide();
        }
        else {
            $('#EA').show();
            $('#EE').show();
            var valor = $('#UnidadNegocio').val();
            var NombreUneg = "";
            if (valor == 1) {
                NombreUneg = 'AUTOFINANCIAMIENTO';
            }
            if (valor == 2) {
                NombreUneg = 'AUTOMOTRIZ';
            }
            if (valor == 3) {
                NombreUneg = 'CORPORATIVO';
            }
            if (valor == 4) {
                NombreUneg = 'FINANCIERA';
            }
            if (valor == 5) {
                NombreUneg = 'INTERNACIONAL';
            }
            if (valor == 6) {
                NombreUneg = 'MANUFACTURA';
            }
            if (valor == 7) {
                NombreUneg = 'OTROS NEGOCIOS';
            }
            if (valor == 8) {
                NombreUneg = 'PRESIDENCIA';
            }
            if (valor == 9) {
                NombreUneg = 'TURISMO';
            }


            $('#cellUNeg').text('UNeg=>' + NombreUneg);
            $('#myTable').show();
        }
    });
    //LLenar tabla(header)
    $('#UnidadNegocio').change(function () {

        if ($('#UnidadNegocio').val() == 0) {
            //omitir
            return false;
        }
        else {

            swal({
                title: "Procesando...",
                text: "Espere...",
                imageUrl: "",
                icon: "/images/load.gif",
                showConfirmButton: false,
                allowOutsideClick: false
            });
            $('.swal-icon').addClass('load');
            $('.load').css('width', '25%');
            $('.load').css('height', '25%');
            $('swal-button-container').css('display', 'none');

            let model = { idCompanyCategoria: $('#UnidadNegocio').val() }


            //Get Perfiles(Tipo funcion)
            $.ajax({
                url: '@Url.Action("GetPerfilesTipoFuncion", "Reporte")',
                type: 'POST',
                success: function (Response) {

                    if (Response != null) {
                        //$('#funcion').prop('colspan', Response.lenght);
                        document.getElementById("funcion").colSpan = Response.length;
                        $.each(Response, function (i, Response) {

                            $('#mergeFuncion').append(

                                '<th class="text-center" scope="col"><strong>Func=>' + Response.Descripcion + '</strong></th>'

                                );
                        });
                    }
                    //Get Condicontrabai
                    $.ajax({
                        url: '@Url.Action("GetCondicionTrabajo", "Reporte")',
                        type: 'POST',
                        success: function (Response) {

                            if (Response != null) {
                                document.getElementById("condicionTrabajo").colSpan = Response.length;
                                $.each(Response, function (i, Response) {

                                    $('#mergeFuncion').append(

                                        '<th class="text-center" scope="col"><strong>CTra=>' + Response.Descripcion + '</strong></th>'

                                        );
                                });
                            }
                            //Get gradoacadem
                            $.ajax({
                                url: '@Url.Action("GetGradoAcademico", "Reporte")',
                                type: 'POST',
                                success: function (Response) {
                                    if (Response != null) {
                                        document.getElementById("gradoAcademico").colSpan = Response.length;
                                        $.each(Response, function (i, Response) {

                                            $('#mergeFuncion').append(
                                                '<th class="text-center" scope="col"><strong>GAca=>' + Response.Descripcion + '</strong></th>'
                                                );
                                        });
                                    }
                                    //Get antiguedad
                                    $.ajax({
                                        url: '@Url.Action("GetAntiguedad", "Reporte")',
                                        type: 'POST',
                                        success: function (Response) {
                                            if (Response != null) {
                                                document.getElementById("Antiguedad").colSpan = Response.length;
                                                $.each(Response, function (i, Response) {
                                                    $('#mergeFuncion').append(
                                                        '<th class="text-center" scope="col"><strong>RAnt=>' + Response.Descripcion + '</strong></th>'
                                                        );
                                                });
                                            }
                                            //Get rangoedad
                                            $.ajax({
                                                url: '@Url.Action("GetRangoEdad", "Reporte")',
                                                type: 'POST',
                                                success: function (Response) {
                                                    document.getElementById("rangoEdad").colSpan = Response.length;
                                                    if (Response != null) {
                                                        $.each(Response, function (i, Response) {
                                                            $('#mergeFuncion').append(
                                                                '<th class="text-center" scope="col"><strong>REda=>' + Response.Descripcion + '</strong></th>'
                                                             );
                                                        });
                                                    }
                                                    let model = { idCompanyCategoria: $('#UnidadNegocio').val() }
                                                    $.ajax({
                                                        url: '@Url.Action("GetCompaniesByUNegocio", "Reporte")',
                                                        type: 'POST',
                                                        data: model,
                                                        success: function (Response) {
                                                            if (Response != null) {
                                                                $.each(Response, function (i, Response) {
                                                                    //  $('#Encabezado').append('<th class="text-center" scope="col" style="background-color:#2F75B5;"><strong>' + Response.CompanyName + '%</strong></th>');
                                                                });
                                                            }
                                                            let model = { idCompanyCategoria: $('#UnidadNegocio').val() }
                                                            $.ajax({
                                                                url: '@Url.Action("GetEstructura", "Reporte")',
                                                                type: 'POST',
                                                                data: model,
                                                                success: function (Response) {
                                                                    if (Response != null) {
                                                                        var newResponse = [new Set(Response)];
                                                                        for (i = 0; i < Response.length; i++) {
                                                                            if (Response[i].CompanyName == null || Response[i].Area.Nombre == "") {
                                                                                //Nothing
                                                                            }
                                                                            else {
                                                                                $('#mergeFuncion').append('<th class="text-center" scope="col" value="Company' + Response[i].CompanyName + '" style="background-color:#2F75B5;"><strong>Comp=>' + Response[i].CompanyName + '</strong></th>');
                                                                            }
                                                                            if (Response[i].Area.Nombre == null || Response[i].Area.Nombre == "") {
                                                                                //Nothing
                                                                            }
                                                                            else {
                                                                                $('#mergeFuncion').append('<th class="text-center" scope="col" style="background-color:#9BC2E6;"><strong>Area=>' + Response[i].Area.Nombre + '</strong></th>');
                                                                            }
                                                                            if (Response[i].Area.Departamento.Nombre == null || Response[i].Area.Departamento.Nombre == "") {
                                                                                //Nothing
                                                                            }
                                                                            else {
                                                                                $('#mergeFuncion').append('<th class="text-center" scope="col" style="background-color:#DDEBF7;"><strong>Dpto=>' + Response[i].Area.Departamento.Nombre + '</strong></th>');
                                                                            }
                                                                            if (Response[i].Area.Departamento.Subdepartamento.Nombre == null || Response[i].Area.Departamento.Subdepartamento.Nombre == "") {
                                                                                //Nothing
                                                                            }
                                                                            else {
                                                                                $('#mergeFuncion').append('<th class="text-center" scope="col" style="background-color:#ffffff;"><strong>SubD=>' + Response[i].Area.Departamento.Subdepartamento.Nombre + '</strong></th>');
                                                                            }
                                                                        }
                                                                        swal.close();
                                                                    }
                                                                    Resize();
                                                                }
                                                            });
                                                        }
                                                    });
                                                }
                                            });
                                        }
                                    });
                                }
                            });
                        }
                    });
                }

            });

        }

    });
    function GetTableFill(IdReporteCL) {
        var mitad1 = '';
        var mitad2 = '';
        swal({
            title: "Procesando...",
            text: "Espere...",
            imageUrl: "",
            icon: "/images/load.gif",
            showConfirmButton: false,
            allowOutsideClick: false
        });
        $('.swal-icon').addClass('load');
        $('.load').css('width', '25%');
        $('.load').css('height', '25%');
        $('swal-button-container').css('display', 'none');
        let model = {
            IdReportCL: IdReporteCL
        };
        $.ajax({
            url: '@Url.Action("GetTableFill1aMitad", "ReportClimaLaboral")',
            type: 'GET',
            data: model,
            complete: function (val) {
                //$('#mergeTableExport').append(val.responseJSON);
                mitad1 = val.responseJSON.Data;
                $.ajax({
                    url: '@Url.Action("GetTableFill2aMitad", "ReportClimaLaboral")',
                    type: 'GET',
                    data: model,
                    complete: function (val) {
                        //$('#mergeTableExport').append(val.responseJSON);
                        mitad2 = val.responseJSON.Data;
                        var tablaFull = mitad1 + mitad2;
                        $('#myTable').remove();
                        $('#mergeTableExport').append(tablaFull);
                        Exportar();
                        swal.close();
                        swal({
                            title: "El reporte se ha generado y descargado de manera correcta!",
                            text: "",
                            type: "success",
                            icon: "success",
                        }).then(function () {
                            window.location.reload(true);
                        });
                    }
                });
            }
        });
    }
    function Resize() {
        $('tr').css('font-size', '10px');
        $('td').css('font-size', '10px');
        $('th').css('font-size', '10px');
    }
    $(document).ready(function () {
        $('#EA').hide();
        $('#EE').hide();
        $('#tableAux').hide();
        $('#mydv').append('<img id="loadImage" class="center" src="/images/load.gif" style="width: 100px; height: 100px;">');
        $('#message').text('Espera mientras se muestran los reportes y su estatus');
        $.ajax({
            url: '@Url.Action("GetReportsgeneratorsCL", "ReportClimaLaboral")',
            data: 0,
            complete: function (val) {
                if (val.responseJSON.length == 0) {
                    $('#message').text('No hay reportes generandose');
                }
                for (var i = 0; i < val.responseJSON.length; i++) {
                    var button = '';
                    var reintenta = '';
                    var buttonDownload = '';
                    if (val.responseJSON[i].ProgresoGeneral != 100) {
                        button = '<input onclick="espera();" title="Espera a que el reporte termine de generarse" type="submit" class="btn btn-success" value="Descargar reporte" >';
                        //if (ultimaHoraInsercion == 20min) {
                        //    reintenta = '<a href="#" title="Reintentar"><i class="fas fa-pause"></i></a>';
                        //}
                        //else{
                        //    reintenta = '<a href="#" title="Reintentar"><i class="fas fa-play"></i></a>';
                        //}
                    }
                    else
                    if ((val.responseJSON[i].ProgresoGeneral == 100 && val.responseJSON[i].TableHTMLFill == null) || (val.responseJSON[i].ProgresoGeneral == 100 && val.responseJSON[i].TableHTMLFill == "")) {
                        //Hace falta generar la tabla llena
                        button = '<input onclick="GenerateTable(' + val.responseJSON[i].IdReportCL + ')" type="submit" class="btn btn-success" value="Ver reporte" >';
                        reintenta = '<a href="#" title="Reintentar"><i class="fas fa-check"></i></a>';
                    }
                    else
                    if ((val.responseJSON[i].ProgresoGeneral == 100 && val.responseJSON[i].TableHTMLFill != null) || (val.responseJSON[i].ProgresoGeneral == 100 && val.responseJSON[i].TableHTMLFill != "")) {
                        button = '<input onclick="GetTableFill(' + val.responseJSON[i].IdReportCL + ')" type="submit" class="btn btn-success" value="Ver reporte" >';
                        reintenta = '<a href="#" title="Reintentar"><i class="fas fa-check"></i></a>';
                    }

                    $('#bodygetReport').append(
                    '<tr>' +
                        '<td class="text-center">' + val.responseJSON[i].IdReportCL + '</td>' +
                        '<td class="text-center">' + val.responseJSON[i].Nombre + '</td>' +
                        '<td class="text-center">' + val.responseJSON[i].UnidadNegocio + '</td>' +
                        '<td class="text-center">' + val.responseJSON[i].Enfoque + '</td>' +
                        '<td class="text-center">' + val.responseJSON[i].ProgresoGeneral + '%<div class="progress" id="jQueryProgressFormBar" style="border: solid 1px black;"> <div class="progress-bar progress-bar-striped progress-bar-animated" id="progressBarHeader" role="progressbar" style="width: ' + val.responseJSON[i].ProgresoGeneral + '%;transition: all 2000ms ease 0s;position: relative;" aria-valuenow="35" aria-valuemin="0" aria-valuemax="100"> <div dir="ltr" class="resize-sensor" style="pointer-events: none; position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"> <div class="resize-sensor-expand" style="pointer-events: none; position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"> <div style="position: absolute; left: 0px; top: 0px; transition: all 0s ease 0s; width: 25px; height: 16px;"> </div> </div> <div class="resize-sensor-shrink" style="pointer-events: none; position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;"> <div style="position: absolute; left: 0px; top: 0px; transition: all 0s ease 0s; width: 200%; height: 200%;"> </div> </div> </div> </div> </div></td>' +
                        //'<td class="text-center"><a href="#" title="Reintentar"><i class="fas fa-spinner fa-spin"></i></a></td>' +
                        '<td class="text-center">' + button + '</td>' +
                    '</tr>'
                    );


                }
                $('#loadImage').remove();
                $('#tableAux').show();
                $('#message').text('Listado de reportes');
            }
        });
    });
    function espera() {
        swal("Espera a que el reporte termine de generarse", "", "info");
    }
    function GenerateTable(IdReportCL) {
        swal({
            title: "Procesando...",
            text: "Espere...",
            imageUrl: "",
            icon: "/images/load.gif",
            showConfirmButton: false,
            allowOutsideClick: false
        });
        $('.swal-icon').addClass('load');
        $('.load').css('width', '25%');
        $('.load').css('height', '25%');
        $('swal-button-container').css('display', 'none');

        let model = {
            IdReportCL: IdReportCL
        };
        $.ajax({
            url: '@Url.Action("GetTableForReport", "ReportClimaLaboral")',
            data: model,
            complete: function (val) {
                if (val.responseJSON != null) {
                    $('#mergeTableExport').append(val.responseJSON[0]);//Tabla
                    $('#myTable').remove();
                    var NoColumnas = val.responseJSON[1];

                    setTimeout(function () {
                        $.ajax({
                            url: '@Url.Action("GetAllDataFromReport", "ReportClimaLaboral")',
                            type: 'GET',
                            data: model,
                            complete: function (Response) {
                                //Do All merge in table
                                console.log(Response);

                                for (var j = 0; j < NoColumnas; j++) {//Ej: 0 - 248
                                    $('#pegarTotalColumnasForEsperadas').append('<th class="text-center"><strong>' + Response.responseJSON[j] + '</strong></th>');
                                }
                                for (var j1 = NoColumnas; j1 < NoColumnas * 2; j1++) {//Ej: 249 - 497
                                    $('#pegarTotalColumnasForContestadas').append('<th class="text-center"><strong>' + Response.responseJSON[j1] + '</strong></th>');
                                }
                                for (var j2 = NoColumnas * 2; j2 < NoColumnas * 3; j2++) {//Ej: 498 - 746
                                    $('.preg1').append('<th class="text-center"><strong>' + Response.responseJSON[j2] + '%</strong></th>');
                                }
                                for (var j3 = NoColumnas * 3; j3 < NoColumnas * 4; j3++) {//Ej: 747 - 995
                                    $('.preg2').append('<th class="text-center"><strong>' + Response.responseJSON[j3] + '%</strong></th>');
                                }
                                for (var j4 = NoColumnas * 4; j4 < NoColumnas * 5; j4++) {//Ej: 996 - 1244
                                    $('.preg3').append('<th class="text-center"><strong>' + Response.responseJSON[j4] + '%</strong></th>');
                                }
                                for (var j5 = NoColumnas * 5; j5 < NoColumnas * 6; j5++) {//Ej: 1245 - ****
                                    $('.preg4').append('<th class="text-center"><strong>' + Response.responseJSON[j5] + '%</strong></th>');
                                }

                                //
                                for (var j6 = NoColumnas * 6; j6 < NoColumnas * 7; j6++) {
                                    $('.preg5').append('<th class="text-center"><strong>' + Response.responseJSON[j6] + '%</strong></th>');
                                }
                                for (var j7 = NoColumnas * 7; j7 < NoColumnas * 8; j7++) {
                                    $('.preg6').append('<th class="text-center"><strong>' + Response.responseJSON[j7] + '%</strong></th>');
                                }
                                for (var j8 = NoColumnas * 8; j8 < NoColumnas * 9; j8++) {
                                    $('.preg7').append('<th class="text-center"><strong>' + Response.responseJSON[j8] + '%</strong></th>');
                                }
                                for (var j9 = NoColumnas * 9; j9 < NoColumnas * 10; j9++) {
                                    $('.preg8').append('<th class="text-center"><strong>' + Response.responseJSON[j9] + '%</strong></th>');
                                }

                                for (var j10 = NoColumnas * 10; j10 < NoColumnas * 11; j10++) {
                                    $('.preg9').append('<th class="text-center"><strong>' + Response.responseJSON[j10] + '%</strong></th>');
                                }
                                for (var j11 = NoColumnas * 11; j11 < NoColumnas * 12; j11++) {
                                    $('.preg10').append('<th class="text-center"><strong>' + Response.responseJSON[j11] + '%</strong></th>');
                                }
                                for (var j12 = NoColumnas * 12; j12 < NoColumnas * 13; j12++) {
                                    $('.preg11').append('<th class="text-center"><strong>' + Response.responseJSON[j12] + '%</strong></th>');
                                }
                                for (var j13 = NoColumnas * 13; j13 < NoColumnas * 14; j13++) {
                                    $('.preg12').append('<th class="text-center"><strong>' + Response.responseJSON[j13] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 14; i < NoColumnas * 15; i++) {
                                    $('.preg13').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 15; i < NoColumnas * 16; i++) {
                                    $('.preg14').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 16; i < NoColumnas * 17; i++) {
                                    $('.preg15').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 17; i < NoColumnas * 18; i++) {
                                    $('.preg16').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 18; i < NoColumnas * 19; i++) {
                                    $('.preg17').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 19; i < NoColumnas * 20; i++) {
                                    $('.preg18').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 20; i < NoColumnas * 21; i++) {
                                    $('.preg19').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 21; i < NoColumnas * 22; i++) {
                                    $('.preg20').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 22; i < NoColumnas * 23; i++) {
                                    $('.preg21').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 23; i < NoColumnas * 24; i++) {
                                    $('.preg22').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 24; i < NoColumnas * 25; i++) {
                                    $('.preg23').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 25; i < NoColumnas * 26; i++) {
                                    $('.preg24').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 26; i < NoColumnas * 27; i++) {
                                    $('.preg25').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 27; i < NoColumnas * 28; i++) {
                                    $('.preg26').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 28; i < NoColumnas * 29; i++) {
                                    $('.preg27').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 29; i < NoColumnas * 30; i++) {
                                    $('.preg28').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 30; i < NoColumnas * 31; i++) {
                                    $('.preg29').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 31; i < NoColumnas * 32; i++) {
                                    $('.preg30').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 32; i < NoColumnas * 33; i++) {
                                    $('.preg31').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 33; i < NoColumnas * 34; i++) {
                                    $('.preg32').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 34; i < NoColumnas * 35; i++) {
                                    $('.preg33').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 35; i < NoColumnas * 36; i++) {
                                    $('.preg34').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 36; i < NoColumnas * 37; i++) {
                                    $('.preg35').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 37; i < NoColumnas * 38; i++) {
                                    $('.preg36').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 38; i < NoColumnas * 39; i++) {
                                    $('.preg37').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 39; i < NoColumnas * 40; i++) {
                                    $('.preg38').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 40; i < NoColumnas * 41; i++) {
                                    $('.preg39').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 41; i < NoColumnas * 42; i++) {
                                    $('.preg40').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 42; i < NoColumnas * 43; i++) {
                                    $('.preg41').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 43; i < NoColumnas * 44; i++) {
                                    $('.preg42').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 44; i < NoColumnas * 45; i++) {
                                    $('.preg43').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 45; i < NoColumnas * 46; i++) {
                                    $('.preg44').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }

                                //Empieza a replicar
                                for (var i = NoColumnas * 46; i < NoColumnas * 47; i++) {
                                    $('.preg45').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 47; i < NoColumnas * 48; i++) {
                                    $('.preg46').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 48; i < NoColumnas * 49; i++) {
                                    $('.preg47').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 49; i < NoColumnas * 50; i++) {
                                    $('.preg48').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 50; i < NoColumnas * 51; i++) {
                                    $('.preg49').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 51; i < NoColumnas * 52; i++) {
                                    $('.preg50').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 52; i < NoColumnas * 53; i++) {
                                    $('.preg51').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 53; i < NoColumnas * 54; i++) {
                                    $('.preg52').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 54; i < NoColumnas * 55; i++) {
                                    $('.preg53').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 55; i < NoColumnas * 56; i++) {
                                    $('.preg54').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 56; i < NoColumnas * 57; i++) {
                                    $('.preg55').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 57; i < NoColumnas * 58; i++) {
                                    $('.preg56').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 58; i < NoColumnas * 59; i++) {
                                    $('.preg57').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 59; i < NoColumnas * 60; i++) {
                                    $('.preg58').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 60; i < NoColumnas * 61; i++) {
                                    $('.preg59').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 61; i < NoColumnas * 62; i++) {
                                    $('.preg60').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 62; i < NoColumnas * 63; i++) {
                                    $('.preg61').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 63; i < NoColumnas * 64; i++) {
                                    $('.preg62').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 64; i < NoColumnas * 65; i++) {
                                    $('.preg63').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 65; i < NoColumnas * 66; i++) {
                                    $('.preg64').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 66; i < NoColumnas * 67; i++) {
                                    $('.preg65').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 67; i < NoColumnas * 68; i++) {
                                    $('.preg66').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 68; i < NoColumnas * 69; i++) {
                                    $('.preg67').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 69; i < NoColumnas * 70; i++) {
                                    $('.preg68').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 70; i < NoColumnas * 71; i++) {
                                    $('.preg69').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 71; i < NoColumnas * 72; i++) {
                                    $('.preg70').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 72; i < NoColumnas * 73; i++) {
                                    $('.preg71').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 73; i < NoColumnas * 74; i++) {
                                    $('.preg72').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 74; i < NoColumnas * 75; i++) {
                                    $('.preg73').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 75; i < NoColumnas * 76; i++) {
                                    $('.preg74').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 76; i < NoColumnas * 77; i++) {
                                    $('.preg75').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 77; i < NoColumnas * 78; i++) {
                                    $('.preg76').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 78; i < NoColumnas * 79; i++) {
                                    $('.preg77').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 79; i < NoColumnas * 80; i++) {
                                    $('.preg78').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 80; i < NoColumnas * 81; i++) {
                                    $('.preg79').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 81; i < NoColumnas * 82; i++) {
                                    $('.preg80').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 82; i < NoColumnas * 83; i++) {
                                    $('.preg81').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 83; i < NoColumnas * 84; i++) {
                                    $('.preg82').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 84; i < NoColumnas * 85; i++) {
                                    $('.preg83').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 85; i < NoColumnas * 86; i++) {
                                    $('.preg84').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 86; i < NoColumnas * 87; i++) {
                                    $('.preg85').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 87; i < NoColumnas * 88; i++) {
                                    $('.preg86').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }


                                //MergePromedios
                                //for (var i = NoColumnas * 88; i < NoColumnas * 89; i++) {
                                //    $('#comodin').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                //}
                                for (var i = NoColumnas * 88; i < NoColumnas * 89; i++) {
                                    $('#mergeParticipacion').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 89; i < NoColumnas * 90; i++) {
                                    $('#mergeCredibilidad').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 90; i < NoColumnas * 91; i++) {
                                    $('#mergeImparcialidad').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 91; i < NoColumnas * 92; i++) {
                                    $('#mergeOrgullo').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 92; i < NoColumnas * 93; i++) {
                                    $('#mergeRespeto').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 93; i < NoColumnas * 94; i++) {
                                    $('#mergeCompañerismo').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 94; i < NoColumnas * 95; i++) {
                                    $('#mergeCoaching').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 95; i < NoColumnas * 96; i++) {
                                    $('#mergeCambio').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 96; i < NoColumnas * 97; i++) {
                                    $('#mergeBienestar').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                //for (var i = NoColumnas * 97; i < NoColumnas * 98; i++) {
                                //    $('#mergeBienestar').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                //}
                                for (var i = NoColumnas * 97; i < NoColumnas * 98; i++) {
                                    $('#mergeAlignCultural').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 98; i < NoColumnas * 99; i++) {
                                    $('#mergeGestalt').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                //for (var i = NoColumnas * 100; i < NoColumnas * 101; i++) {
                                //    $('#mergeConfianza').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                //}
                                for (var i = NoColumnas * 99; i < NoColumnas * 100; i++) {
                                    $('#mergeProm66React').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 100; i < NoColumnas * 101; i++) {
                                    $('#mergeProm86React').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                //*************
                                //for (var i = NoColumnas * 103; i < NoColumnas * 104; i++) {
                                //    $('#mergePracticasCulturales').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                //}
                                for (var i = NoColumnas * 101; i < NoColumnas * 102; i++) {
                                    $('#mergeReclutandoBienvenida').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 102; i < NoColumnas * 103; i++) {
                                    $('#mergePromediosInspirando').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 103; i < NoColumnas * 104; i++) {
                                    $('#mergePromedioHablando').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 104; i < NoColumnas * 105; i++) {
                                    $('#mergePromedioEscuchando').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 105; i < NoColumnas * 106; i++) {
                                    $('#mergePromedioAgradeciendo').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 106; i < NoColumnas * 107; i++) {
                                    $('#mergePromedioDesarrollando').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 107; i < NoColumnas * 108; i++) {
                                    $('#mergePromedioCuidando').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 108; i < NoColumnas * 109; i++) {
                                    $('#mergePromedioPercepcionLugar').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }


                                for (var i = NoColumnas * 109; i < NoColumnas * 110; i++) {
                                    $('#mergePromedioCooperando').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 110; i < NoColumnas * 111; i++) {
                                    $('#mergePromedioAlinEstrategica').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }


                                //**************
                                //for (var i = NoColumnas * 114; i < NoColumnas * 115; i++) {
                                //    $('#mergePromedioProcesosOrgan').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                //}
                                for (var i = NoColumnas * 111; i < NoColumnas * 112; i++) {
                                    $('#mergeBalanceVida').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 112; i < NoColumnas * 113; i++) {
                                    $('#mergeReclutamiento').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 113; i < NoColumnas * 114; i++) {
                                    $('#mergePlanesCarrera').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 114; i < NoColumnas * 115; i++) {
                                    $('#mergePromCapacitacionDesarrollo').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 115; i < NoColumnas * 116; i++) {
                                    $('#mergePromedioEMPOWERMENT').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 116; i < NoColumnas * 117; i++) {
                                    $('#mergeEvalDesempeño').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }



                                for (var i = NoColumnas * 117; i < NoColumnas * 118; i++) {
                                    $('#mergePoliticaCompensacion').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 118; i < NoColumnas * 119; i++) {
                                    $('#mergePromedioReconocimientoInst').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 119; i < NoColumnas * 120; i++) {
                                    $('#mergePromedioIntegracion').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 120; i < NoColumnas * 121; i++) {
                                    $('#mergeCanalesInst').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }

                                //*****

                                for (var i = NoColumnas * 121; i < NoColumnas * 122; i++) {
                                    $('#mergeNivelCoolaboracion').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 122; i < NoColumnas * 123; i++) {
                                    $('#mergePromedioNivelCompromiso').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 123; i < NoColumnas * 124; i++) {
                                    $('#mergePromedioFactorSocial').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 124; i < NoColumnas * 125; i++) {
                                    $('#mergePromedioPsico').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 125; i < NoColumnas * 126; i++) {
                                    $('#mergePromFactorFisico').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 126; i < NoColumnas * 127; i++) {
                                    $('#mergealincultral').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 127; i < NoColumnas * 128; i++) {
                                    $('#mergebienestarss').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 128; i < NoColumnas * 129; i++) {
                                    $('#mergePromedioBio').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 129; i < NoColumnas * 130; i++) {
                                    $('#mergerPsicos').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 130; i < NoColumnas * 131; i++) {
                                    $('#mergePromSocial').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }

                                for (var i = NoColumnas * 131; i < NoColumnas * 132; i++) {
                                    $('#mergePromedioComunicacion').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 132; i < NoColumnas * 133; i++) {
                                    $('#mergePromedioEnpow').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 133; i < NoColumnas * 134; i++) {
                                    $('#mergecoordinaciontrabajo').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 134; i < NoColumnas * 135; i++) {
                                    $('#mergePromVisionEstr').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                for (var i = NoColumnas * 135; i < NoColumnas * 136; i++) {
                                    $('#mergePromedioNivelDese').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }
                                //La tabla que se muestra en customreport correfir el id de iso y del rpomediode los naranja
                                for (var i = NoColumnas * 136; i < NoColumnas * 137; i++) {
                                    $('.col-lg-8').append('<th class="text-center"><strong>' + Response.responseJSON[i] + '%</strong></th>');
                                }


                                setISO();
                                setNaranjas();
                                setConfianza();
                                setPracticasCulturales();
                                setProcesosOrganizacionales();
                                setComodin();
                                setImpulsoresClave();
                                Exportar();

                                //Set tableReport terminada
                                var tablePureHtmlS = '<table id="tableReport" class="table table-responsive table-bordered">';
                                tablePureHtmlS += $('#tableReport').html();
                                tablePureHtmlS += '</table>';
                                tablePureHtmlS = tablePureHtmlS.replace(/  /g, '')
                                tablePureHtmlS = tablePureHtmlS.replace(/(\r\n|\n|\r)/gm, "");

                                let modelo = {
                                    tableHTML: tablePureHtmlS,
                                    IdReportCL: IdReportCL
                                };


                                $.ajax({
                                    url: '@Url.Action("SetTableFill", "ReportClimaLaboral")',
                                    type: 'POST',
                                    data: modelo, traditional: true,
                                    complete: function () {
                                        swal.close();
                                        swal({
                                            title: "El reporte se ha generado y descargado de manera correcta!",
                                            text: "",
                                            type: "success",
                                            icon: "success",
                                        }).then(function () {
                                            window.location.reload(true);
                                        });
                                    },
                                    error: function (res) {
                                        console.log(res);
                                    }
                                });
                            }
                        });
                    }, 3000);
                }
                else {
                    swal("No se pudo obtener la tabla del reporte", "", "info");
                }
            }
        });
    }
    function Exportar() {
        $("#tableReport").table2excel({
            // exclude CSS class
            exclude: ".noExl",
            name: "Worksheet",
            filename: "Reporte Clima Laboral", //do not include extension
            fileext: ".xls", // file extension
            preserveColors: true,
            exclude_img: false,
            exclude_links: false,
            exclude_inputs: false
        });
    }
</script>
<script>
    function setComodin() {
        //#comodin
        // 24  25  27 => raza sexo  preferencia
        var filtro1 = [];
        var filtro2 = [];
        var filtro3 = [];
        //GET Factor Social
        var columnas = document.getElementById('tableReport').rows[24].cells.length;

        var filtros = [];

        for (var i = 1; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[24].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro1.push(cellValue);
        }
        console.log(filtro1);
        //GET Factor psicologico
        var columnas = document.getElementById('tableReport').rows[25].cells.length;

        var filtros = [];

        for (var i = 1; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[25].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro2.push(cellValue);
        }
        console.log(filtro2);
        //GET Facor fisico
        var columnas = document.getElementById('tableReport').rows[27].cells.length;

        var filtros = [];

        for (var i = 1; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[27].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro3.push(cellValue);
        }
        console.log(filtro3);


        //Sumar los listFiltros
        for (var i = 0; i < filtro1.length; i++) {
            var valor1 = parseFloat(filtro1[i]);
            var valor2 = parseFloat(filtro2[i]);
            var valor3 = parseFloat(filtro3[i]);
            var prom = (valor1 + valor2 + valor3) / 3;
            $('#comodin').append(
              '<th class="text-center"><strong>' + prom.toFixed(2) + '%</strong></th>'
            );
        }
    }
    function setISO() {
        var filtro1 = [];
        var filtro2 = [];
        var filtro3 = [];
        //GET Factor Social
        var columnas = document.getElementById('tableReport').rows[214].cells.length;

        var filtros = [];

        for (var i = 1; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[214].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro1.push(cellValue);
        }
        console.log(filtro1);
        //GET Factor psicologico
        var columnas = document.getElementById('tableReport').rows[214].cells.length;

        var filtros = [];

        for (var i = 1; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[221].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro2.push(cellValue);
        }
        console.log(filtro2);
        //GET Facor fisico
        var columnas = document.getElementById('tableReport').rows[214].cells.length;

        var filtros = [];

        for (var i = 1; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[227].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro3.push(cellValue);
        }
        console.log(filtro3);


        //Sumar los listFiltros
        for (var i = 0; i < filtro1.length; i++) {
            var valor1 = parseFloat(filtro1[i]);
            var valor2 = parseFloat(filtro2[i]);
            var valor3 = parseFloat(filtro3[i]);
            var prom = (valor1 + valor2 + valor3) / 3;
            $('#mergeIso').append(
              '<th class="text-center"><strong>' + prom.toFixed(2) + '%</strong></th>'
            );
        }

    }

    function setNaranjas() {
        var filtro1 = [];
        var filtro2 = [];
        var filtro3 = [];
        var filtro4 = [];
        var filtro5 = [];
        //GET Factor Social
        var columnas = document.getElementById('tableReport').rows[262].cells.length;

        var filtros = [];

        for (var i = 1; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[262].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro1.push(cellValue);
        }
        console.log(filtro1);
        //GET Factor psicologico


        var filtros = [];

        for (var i = 1; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[268].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro2.push(cellValue);
        }
        console.log(filtro2);
        //GET Facor fisico


        var filtros = [];

        for (var i = 1; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[272].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro3.push(cellValue);
        }
        console.log(filtro3);


        for (var i = 1; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[278].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro4.push(cellValue);
        }
        console.log(filtro4);

        for (var i = 1; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[281].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro5.push(cellValue);
        }
        console.log(filtro5);

        //Sumar los listFiltros
        for (var i = 0; i < filtro1.length; i++) {
            var valor1 = parseFloat(filtro1[i]);
            var valor2 = parseFloat(filtro2[i]);
            var valor3 = parseFloat(filtro3[i]);
            var valor4 = parseFloat(filtro4[i]);
            var valor5 = parseFloat(filtro5[i]);

            var prom = (valor1 + valor2 + valor3 + valor4 + valor5) / 5;
            $('#mergePromNaranja').append(
              '<th class="text-center"><strong>' + prom.toFixed(2) + '%</strong></th>'
            );
        }
    }

    function setImpulsoresClave() {

        var filtro1 = [];
        var filtro2 = [];
        var filtro3 = [];
        var filtro4 = [];
        var filtro5 = [];
        var filtro6 = [];
        var filtro7 = [];
        var filtro8 = [];

        var columnas = document.getElementById('tableReport').rows[197].cells.length;
        for (var i = 1; i < columnas; i++) {//Nivel de Colaboración
            var cellValue = document.getElementById('tableReport').rows[197].cells[i].innerText;
            filtro1.push(cellValue);
        }
        console.log(filtro1);

        columnas = document.getElementById('tableReport').rows[260].cells.length;
        for (var i = 1; i < columnas; i++) {//Habilidades Gerenciales
            var cellValue = document.getElementById('tableReport').rows[260].cells[i].innerText;
            filtro2.push(cellValue);
        }
        console.log(filtro2);

        columnas = document.getElementById('tableReport').rows[109].cells.length;
        for (var i = 2; i < columnas; i++) {//Coaching
            var cellValue = document.getElementById('tableReport').rows[109].cells[i].innerText;
            filtro3.push(cellValue);
        }
        console.log(filtro3);

        columnas = document.getElementById('tableReport').rows[110].cells.length;
        for (var i = 2; i < columnas; i++) {//Cambio
            var cellValue = document.getElementById('tableReport').rows[110].cells[i].innerText;
            filtro4.push(cellValue);
        }
        console.log(filtro4);

        columnas = document.getElementById('tableReport').rows[116].cells.length;
        for (var i = 2; i < columnas; i++) {//Nivel de Confianza
            var cellValue = document.getElementById('tableReport').rows[116].cells[i].innerText;
            filtro5.push(cellValue);
        }
        console.log(filtro5);

        columnas = document.getElementById('tableReport').rows[163].cells.length;
        for (var i = 1; i < columnas; i++) {//Alineación Estratégica
            var cellValue = document.getElementById('tableReport').rows[163].cells[i].innerText;
            filtro6.push(cellValue);
        }
        console.log(filtro6);

        columnas = document.getElementById('tableReport').rows[124].cells.length;
        for (var i = 1; i < columnas; i++) {//Prácticas Culturales
            var cellValue = document.getElementById('tableReport').rows[124].cells[i].innerText;
            filtro7.push(cellValue);
        }
        console.log(filtro7);

        columnas = document.getElementById('tableReport').rows[168].cells.length;
        for (var i = 1; i < columnas; i++) {//Procesos Organizacionales
            var cellValue = document.getElementById('tableReport').rows[168].cells[i].innerText;
            filtro8.push(cellValue);
        }
        console.log(filtro8);

        //Sumar los listFiltros
        for (var i = 0; i < filtro1.length; i++) {
            var valor1 = parseFloat(filtro1[i]);
            var valor2 = parseFloat(filtro2[i]);
            var valor3 = parseFloat(filtro3[i]);
            var valor4 = parseFloat(filtro4[i]);
            var valor5 = parseFloat(filtro5[i]);
            var valor6 = parseFloat(filtro6[i]);
            var valor7 = parseFloat(filtro7[i]);
            var valor8 = parseFloat(filtro8[i]);

            var prom = (valor1 + valor2 + valor3 + valor4 + valor5 + valor6 + valor7 + valor8) / 8;
            $('#mergeLogroDeResultados').append(
              '<th class="text-center"><strong>' + prom.toFixed(2) + '%</strong></th>'
            );
        }

    }
</script>
<script>
    /*
 *  jQuery table2excel - v1.1.2
 *  jQuery plugin to export an .xls file in browser from an HTML table
 *  https://github.com/rainabba/jquery-table2excel
 *
 *  Made by rainabba
 *  Under MIT License
 */
    //table2excel.js
    (function ($, window, document, undefined) {
        var pluginName = "table2excel",

        defaults = {
            exclude: ".noExl",
            name: "Table2Excel",
            filename: "table2excel",
            fileext: ".xls",
            exclude_img: true,
            exclude_links: true,
            exclude_inputs: true,
            preserveColors: false
        };

        // The actual plugin constructor
        function Plugin(element, options) {
            this.element = element;
            // jQuery has an extend method which merges the contents of two or
            // more objects, storing the result in the first object. The first object
            // is generally empty as we don't want to alter the default options for
            // future instances of the plugin
            //
            this.settings = $.extend({}, defaults, options);
            this._defaults = defaults;
            this._name = pluginName;
            this.init();
        }

        Plugin.prototype = {
            init: function () {
                var e = this;

                var utf8Heading = "<meta http-equiv=\"content-type\" content=\"application/vnd.ms-excel; charset=UTF-8\">";
                e.template = {
                    head: "<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\">" + utf8Heading + "<head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>",
                    sheet: {
                        head: "<x:ExcelWorksheet><x:Name>",
                        tail: "</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"
                    },
                    mid: "</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>",
                    table: {
                        head: "<table>",
                        tail: "</table>"
                    },
                    foot: "</body></html>"
                };

                e.tableRows = [];

                // Styling variables
                var additionalStyles = "";
                var compStyle = null;

                // get contents of table except for exclude
                $(e.element).each(function (i, o) {
                    var tempRows = "";
                    $(o).find("tr").not(e.settings.exclude).each(function (i, p) {

                        // Reset for this row
                        additionalStyles = "";

                        // Preserve background and text colors on the row
                        if (e.settings.preserveColors) {
                            compStyle = getComputedStyle(p);
                            additionalStyles += (compStyle && compStyle.backgroundColor ? "background-color: " + compStyle.backgroundColor + ";" : "");
                            additionalStyles += (compStyle && compStyle.color ? "color: " + compStyle.color + ";" : "");
                        }

                        // Create HTML for Row
                        tempRows += "<tr style='" + additionalStyles + "'>";

                        // Loop through each TH and TD
                        $(p).find("td,th").not(e.settings.exclude).each(function (i, q) { // p did not exist, I corrected

                            // Reset for this column
                            additionalStyles = "";

                            // Preserve background and text colors on the row
                            if (e.settings.preserveColors) {
                                compStyle = getComputedStyle(q);
                                additionalStyles += (compStyle && compStyle.backgroundColor ? "background-color: " + compStyle.backgroundColor + ";" : "");
                                additionalStyles += (compStyle && compStyle.color ? "color: " + compStyle.color + ";" : "");
                            }

                            var rc = {
                                rows: $(this).attr("rowspan"),
                                cols: $(this).attr("colspan"),
                                flag: $(q).find(e.settings.exclude)
                            };

                            if (rc.flag.length > 0) {
                                tempRows += "<td> </td>"; // exclude it!!
                            } else {
                                tempRows += "<td";
                                if (rc.rows > 0) {
                                    tempRows += " rowspan='" + rc.rows + "' ";
                                }
                                if (rc.cols > 0) {
                                    tempRows += " colspan='" + rc.cols + "' ";
                                }
                                if (additionalStyles) {
                                    tempRows += " style='" + additionalStyles + "'";
                                }
                                tempRows += ">" + $(q).html() + "</td>";
                            }
                        });

                        tempRows += "</tr>";

                    });
                    // exclude img tags
                    if (e.settings.exclude_img) {
                        tempRows = exclude_img(tempRows);
                    }

                    // exclude link tags
                    if (e.settings.exclude_links) {
                        tempRows = exclude_links(tempRows);
                    }

                    // exclude input tags
                    if (e.settings.exclude_inputs) {
                        tempRows = exclude_inputs(tempRows);
                    }
                    e.tableRows.push(tempRows);
                });

                e.tableToExcel(e.tableRows, e.settings.name, e.settings.sheetName);
            },

            tableToExcel: function (table, name, sheetName) {
                var e = this, fullTemplate = "", i, link, a;

                e.format = function (s, c) {
                    return s.replace(/{(\w+)}/g, function (m, p) {
                        return c[p];
                    });
                };

                sheetName = typeof sheetName === "undefined" ? "Sheet" : sheetName;

                e.ctx = {
                    worksheet: name || "Worksheet",
                    table: table,
                    sheetName: sheetName
                };

                fullTemplate = e.template.head;

                if ($.isArray(table)) {
                    Object.keys(table).forEach(function (i) {
                        //fullTemplate += e.template.sheet.head + "{worksheet" + i + "}" + e.template.sheet.tail;
                        fullTemplate += e.template.sheet.head + sheetName + i + e.template.sheet.tail;
                    });
                }

                fullTemplate += e.template.mid;

                if ($.isArray(table)) {
                    Object.keys(table).forEach(function (i) {
                        fullTemplate += e.template.table.head + "{table" + i + "}" + e.template.table.tail;
                    });
                }

                fullTemplate += e.template.foot;

                for (i in table) {
                    e.ctx["table" + i] = table[i];
                }
                delete e.ctx.table;

                var isIE = navigator.appVersion.indexOf("MSIE 10") !== -1 || (navigator.userAgent.indexOf("Trident") !== -1 && navigator.userAgent.indexOf("rv:11") !== -1); // this works with IE10 and IE11 both :)
                //if (typeof msie !== "undefined" && msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // this works ONLY with IE 11!!!
                if (isIE) {
                    if (typeof Blob !== "undefined") {
                        //use blobs if we can
                        fullTemplate = e.format(fullTemplate, e.ctx); // with this, works with IE
                        fullTemplate = [fullTemplate];
                        //convert to array
                        var blob1 = new Blob(fullTemplate, { type: "text/html" });
                        window.navigator.msSaveBlob(blob1, getFileName(e.settings));
                    } else {
                        //otherwise use the iframe and save
                        //requires a blank iframe on page called txtArea1
                        txtArea1.document.open("text/html", "replace");
                        txtArea1.document.write(e.format(fullTemplate, e.ctx));
                        txtArea1.document.close();
                        txtArea1.focus();
                        sa = txtArea1.document.execCommand("SaveAs", true, getFileName(e.settings));
                    }

                } else {
                    var blob = new Blob([e.format(fullTemplate, e.ctx)], { type: "application/vnd.ms-excel" });
                    window.URL = window.URL || window.webkitURL;
                    link = window.URL.createObjectURL(blob);
                    a = document.createElement("a");
                    a.download = getFileName(e.settings);
                    a.href = link;
                    
                    try {
                        alert(a.href);
                        alert(link);
                    } catch (e) {

                    }
                    

                    document.body.appendChild(a);

                    a.click();

                    document.body.removeChild(a);
                }

                return true;
            }
        };

        function getFileName(settings) {
            return (settings.filename ? settings.filename : "table2excel");
        }

        // Removes all img tags
        function exclude_img(string) {
            var _patt = /(\s+alt\s*=\s*"([^"]*)"|\s+alt\s*=\s*'([^']*)')/i;
            return string.replace(/<img[^>]*>/gi, function myFunction(x) {
                var res = _patt.exec(x);
                if (res !== null && res.length >= 2) {
                    return res[2];
                } else {
                    return "";
                }
            });
        }

        // Removes all link tags
        function exclude_links(string) {
            return string.replace(/<a[^>]*>|<\/a>/gi, "");
        }

        // Removes input params
        function exclude_inputs(string) {
            var _patt = /(\s+value\s*=\s*"([^"]*)"|\s+value\s*=\s*'([^']*)')/i;
            return string.replace(/<input[^>]*>|<\/input>/gi, function myFunction(x) {
                var res = _patt.exec(x);
                if (res !== null && res.length >= 2) {
                    return res[2];
                } else {
                    return "";
                }
            });
        }

        $.fn[pluginName] = function (options) {
            var e = this;
            e.each(function () {
                if (!$.data(e, "plugin_" + pluginName)) {
                    $.data(e, "plugin_" + pluginName, new Plugin(this, options));
                }
            });

            // chain jQuery functions
            return e;
        };

    })(jQuery, window, document);
</script>
<script>
    function setConfianza() {
        //mergeConfianza
        //3 5 7
        //row 6, 12, 15
        var filtro1 = [];
        var filtro2 = [];
        var filtro3 = [];
        //GET Factor Social
        var columnas = document.getElementById('tableReport').rows[104].cells.length;

        var filtros = [];

        for (var i = 2; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[104].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro1.push(cellValue);
        }
        console.log(filtro1);
        //GET Factor psicologico
        var columnas = document.getElementById('tableReport').rows[105].cells.length;

        var filtros = [];

        for (var i = 2; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[105].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro2.push(cellValue);
        }
        console.log(filtro2);
        //GET Facor fisico
        var columnas = document.getElementById('tableReport').rows[107].cells.length;

        var filtros = [];

        for (var i = 2; i < columnas; i++) {
            var cellValue = document.getElementById('tableReport').rows[107].cells[i].innerText;
            //filtros.push(document.getElementById('myTable').rows[1].cells[i].innerText);
            filtro3.push(cellValue);
        }
        console.log(filtro3);


        //Sumar los listFiltros
        for (var i = 0; i < filtro1.length; i++) {
            var valor1 = parseFloat(filtro1[i]);
            var valor2 = parseFloat(filtro2[i]);
            var valor3 = parseFloat(filtro3[i]);
            var prom = (valor1 + valor2 + valor3) / 3;
            $('#mergeConfianza').append(
              '<th class="text-center"><strong>' + prom.toFixed(2) + '%</strong></th>'
            );
        }
    }



    function setImpulsoresClave() {

        var filtro1 = [];
        var filtro2 = [];
        var filtro3 = [];
        var filtro4 = [];
        var filtro5 = [];
        var filtro6 = [];
        var filtro7 = [];
        var filtro8 = [];

        var columnas = document.getElementById('tableReport').rows[197].cells.length;
        for (var i = 1; i < columnas; i++) {//Nivel de Colaboración
            var cellValue = document.getElementById('tableReport').rows[197].cells[i].innerText;
            filtro1.push(cellValue);
        }
        console.log(filtro1);

        columnas = document.getElementById('tableReport').rows[260].cells.length;
        for (var i = 1; i < columnas; i++) {//Habilidades Gerenciales
            var cellValue = document.getElementById('tableReport').rows[260].cells[i].innerText;
            filtro2.push(cellValue);
        }
        console.log(filtro2);

        columnas = document.getElementById('tableReport').rows[109].cells.length;
        for (var i = 2; i < columnas; i++) {//Coaching
            var cellValue = document.getElementById('tableReport').rows[109].cells[i].innerText;
            filtro3.push(cellValue);
        }
        console.log(filtro3);

        columnas = document.getElementById('tableReport').rows[110].cells.length;
        for (var i = 2; i < columnas; i++) {//Cambio
            var cellValue = document.getElementById('tableReport').rows[110].cells[i].innerText;
            filtro4.push(cellValue);
        }
        console.log(filtro4);

        columnas = document.getElementById('tableReport').rows[116].cells.length;
        for (var i = 2; i < columnas; i++) {//Nivel de Confianza
            var cellValue = document.getElementById('tableReport').rows[116].cells[i].innerText;
            filtro5.push(cellValue);
        }
        console.log(filtro5);

        columnas = document.getElementById('tableReport').rows[163].cells.length;
        for (var i = 1; i < columnas; i++) {//Alineación Estratégica
            var cellValue = document.getElementById('tableReport').rows[163].cells[i].innerText;
            filtro6.push(cellValue);
        }
        console.log(filtro6);

        columnas = document.getElementById('tableReport').rows[124].cells.length;
        for (var i = 1; i < columnas; i++) {//Prácticas Culturales
            var cellValue = document.getElementById('tableReport').rows[124].cells[i].innerText;
            filtro7.push(cellValue);
        }
        console.log(filtro7);

        columnas = document.getElementById('tableReport').rows[168].cells.length;
        for (var i = 1; i < columnas; i++) {//Procesos Organizacionales
            var cellValue = document.getElementById('tableReport').rows[168].cells[i].innerText;
            filtro8.push(cellValue);
        }
        console.log(filtro8);

        //Sumar los listFiltros
        for (var i = 0; i < filtro1.length; i++) {
            var valor1 = parseFloat(filtro1[i]);
            var valor2 = parseFloat(filtro2[i]);
            var valor3 = parseFloat(filtro3[i]);
            var valor4 = parseFloat(filtro4[i]);
            var valor5 = parseFloat(filtro5[i]);
            var valor6 = parseFloat(filtro6[i]);
            var valor7 = parseFloat(filtro7[i]);
            var valor8 = parseFloat(filtro8[i]);

            var prom = (valor1 + valor2 + valor3 + valor4 + valor5 + valor6 + valor7 + valor8) / 8;
            $('#mergeLogroDeResultados').append(
              '<th class="text-center"><strong>' + prom.toFixed(2) + '%</strong></th>'
            );
        }

    }

    function setPracticasCulturales() {
        var filtro1 = [];
        var filtro2 = [];
        var filtro3 = [];
        var filtro4 = [];
        var filtro5 = [];
        var filtro6 = [];
        var filtro7 = [];
        var filtro8 = [];
        var filtro9 = [];

        var columnas = document.getElementById('tableReport').rows[126].cells.length;
        for (var i = 1; i < columnas; i++) {//Nivel de Colaboración
            var cellValue = document.getElementById('tableReport').rows[126].cells[i].innerText;
            filtro1.push(cellValue);
        }
        console.log(filtro1);

        columnas = document.getElementById('tableReport').rows[129].cells.length;
        for (var i = 1; i < columnas; i++) {//Habilidades Gerenciales
            var cellValue = document.getElementById('tableReport').rows[129].cells[i].innerText;
            filtro2.push(cellValue);
        }
        console.log(filtro2);

        columnas = document.getElementById('tableReport').rows[134].cells.length;
        for (var i = 1; i < columnas; i++) {//Coaching
            var cellValue = document.getElementById('tableReport').rows[134].cells[i].innerText;
            filtro3.push(cellValue);
        }
        console.log(filtro3);

        columnas = document.getElementById('tableReport').rows[138].cells.length;
        for (var i = 1; i < columnas; i++) {//Cambio
            var cellValue = document.getElementById('tableReport').rows[138].cells[i].innerText;
            filtro4.push(cellValue);
        }
        console.log(filtro4);

        columnas = document.getElementById('tableReport').rows[143].cells.length;
        for (var i = 1; i < columnas; i++) {//Nivel de Confianza
            var cellValue = document.getElementById('tableReport').rows[143].cells[i].innerText;
            filtro5.push(cellValue);
        }
        console.log(filtro5);

        columnas = document.getElementById('tableReport').rows[146].cells.length;
        for (var i = 1; i < columnas; i++) {//Alineación Estratégica
            var cellValue = document.getElementById('tableReport').rows[146].cells[i].innerText;
            filtro6.push(cellValue);
        }
        console.log(filtro6);

        columnas = document.getElementById('tableReport').rows[151].cells.length;
        for (var i = 1; i < columnas; i++) {//Prácticas Culturales
            var cellValue = document.getElementById('tableReport').rows[151].cells[i].innerText;
            filtro7.push(cellValue);
        }
        console.log(filtro7);

        columnas = document.getElementById('tableReport').rows[156].cells.length;
        for (var i = 1; i < columnas; i++) {//Procesos Organizacionales
            var cellValue = document.getElementById('tableReport').rows[156].cells[i].innerText;
            filtro8.push(cellValue);
        }
        console.log(filtro8);

        columnas = document.getElementById('tableReport').rows[159].cells.length;
        for (var i = 1; i < columnas; i++) {//Procesos Organizacionales
            var cellValue = document.getElementById('tableReport').rows[159].cells[i].innerText;
            filtro9.push(cellValue);
        }
        console.log(filtro9);

        //Sumar los listFiltros
        for (var i = 0; i < filtro1.length; i++) {
            var valor1 = parseFloat(filtro1[i]);
            var valor2 = parseFloat(filtro2[i]);
            var valor3 = parseFloat(filtro3[i]);
            var valor4 = parseFloat(filtro4[i]);
            var valor5 = parseFloat(filtro5[i]);
            var valor6 = parseFloat(filtro6[i]);
            var valor7 = parseFloat(filtro7[i]);
            var valor8 = parseFloat(filtro8[i]);
            var valor9 = parseFloat(filtro9[i]);

            var prom = (valor1 + valor2 + valor3 + valor4 + valor5 + valor6 + valor7 + valor8 + valor9) / 9;
            $('#mergePracticasCulturales').append(
              '<th class="text-center"><strong>' + prom.toFixed(2) + '%</strong></th>'
            );
        }
    }
        </script>
<script>
    function setProcesosOrganizacionales() {
        var filtro1 = [];
        var filtro2 = [];
        var filtro3 = [];
        var filtro4 = [];
        var filtro5 = [];
        var filtro6 = [];
        var filtro7 = [];
        var filtro8 = [];
        var filtro9 = [];
        var filtro10 = [];

        var columnas = document.getElementById('tableReport').rows[170].cells.length;
        for (var i = 1; i < columnas; i++) {//Nivel de Colaboración
            var cellValue = document.getElementById('tableReport').rows[170].cells[i].innerText;
            filtro1.push(cellValue);
        }
        console.log(filtro1);

        columnas = document.getElementById('tableReport').rows[172].cells.length;
        for (var i = 1; i < columnas; i++) {//Habilidades Gerenciales
            var cellValue = document.getElementById('tableReport').rows[172].cells[i].innerText;
            filtro2.push(cellValue);
        }
        console.log(filtro2);

        columnas = document.getElementById('tableReport').rows[174].cells.length;
        for (var i = 1; i < columnas; i++) {//Coaching
            var cellValue = document.getElementById('tableReport').rows[174].cells[i].innerText;
            filtro3.push(cellValue);
        }
        console.log(filtro3);

        columnas = document.getElementById('tableReport').rows[177].cells.length;
        for (var i = 1; i < columnas; i++) {//Cambio
            var cellValue = document.getElementById('tableReport').rows[177].cells[i].innerText;
            filtro4.push(cellValue);
        }
        console.log(filtro4);

        columnas = document.getElementById('tableReport').rows[180].cells.length;
        for (var i = 1; i < columnas; i++) {//Nivel de Confianza
            var cellValue = document.getElementById('tableReport').rows[180].cells[i].innerText;
            filtro5.push(cellValue);
        }
        console.log(filtro5);

        columnas = document.getElementById('tableReport').rows[183].cells.length;
        for (var i = 1; i < columnas; i++) {//Alineación Estratégica
            var cellValue = document.getElementById('tableReport').rows[183].cells[i].innerText;
            filtro6.push(cellValue);
        }
        console.log(filtro6);

        columnas = document.getElementById('tableReport').rows[186].cells.length;
        for (var i = 1; i < columnas; i++) {//Prácticas Culturales
            var cellValue = document.getElementById('tableReport').rows[186].cells[i].innerText;
            filtro7.push(cellValue);
        }
        console.log(filtro7);

        columnas = document.getElementById('tableReport').rows[188].cells.length;
        for (var i = 1; i < columnas; i++) {//Procesos Organizacionales
            var cellValue = document.getElementById('tableReport').rows[188].cells[i].innerText;
            filtro8.push(cellValue);
        }
        console.log(filtro8);

        columnas = document.getElementById('tableReport').rows[190].cells.length;
        for (var i = 1; i < columnas; i++) {//Procesos Organizacionales
            var cellValue = document.getElementById('tableReport').rows[190].cells[i].innerText;
            filtro9.push(cellValue);
        }
        console.log(filtro9);

        columnas = document.getElementById('tableReport').rows[194].cells.length;
        for (var i = 1; i < columnas; i++) {//Procesos Organizacionales
            var cellValue = document.getElementById('tableReport').rows[194].cells[i].innerText;
            filtro10.push(cellValue);
        }
        console.log(filtro10);

        //Sumar los listFiltros
        for (var i = 0; i < filtro1.length; i++) {
            var valor1 = parseFloat(filtro1[i]);
            var valor2 = parseFloat(filtro2[i]);
            var valor3 = parseFloat(filtro3[i]);
            var valor4 = parseFloat(filtro4[i]);
            var valor5 = parseFloat(filtro5[i]);
            var valor6 = parseFloat(filtro6[i]);
            var valor7 = parseFloat(filtro7[i]);
            var valor8 = parseFloat(filtro8[i]);
            var valor9 = parseFloat(filtro9[i]);
            var valor10 = parseFloat(filtro10[i]);

            var prom = (valor1 + valor2 + valor3 + valor4 + valor5 + valor6 + valor7 + valor8 + valor9 + valor10) / 10;
            $('#mergePromedioProcesosOrgan').append(
              '<th class="text-center"><strong>' + prom.toFixed(2) + '%</strong></th>'
            );
        }
    }
</script>
}
